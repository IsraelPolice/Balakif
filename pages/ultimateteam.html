<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>×”×—×‘×¨'×” ×”×˜×•×‘×™× - Ultimate Team</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideIn { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    @keyframes dance {
      0% { transform: rotate(0deg); }
      25% { transform: rotate(5deg); }
      50% { transform: rotate(0deg); }
      75% { transform: rotate(-5deg); }
      100% { transform: rotate(0deg); }
    }
    body { font-family: 'Arial', sans-serif; direction: rtl; background: linear-gradient(to bottom, #1a202c, #2d3748); color: white; }
    .card { transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3); }
    .star { color: #FFD700; }
    .popup { animation: fadeIn 0.5s ease-in-out; }
    .player-reveal { animation: slideIn 0.5s ease-in-out; }
    .dance { animation: dance 0.5s infinite; }
    #error { display: none; color: #fc8181; }
    .player-card { background: linear-gradient(135deg, #4b5e7e, #2d3748); border: 2px solid #FFD700; }
  </style>
</head>
<body class="min-h-screen p-4">
  <div id="welcome-screen" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
    <div class="bg-gray-800 p-8 rounded-xl shadow-2xl max-w-md w-full text-center popup">
      <h1 class="text-3xl font-bold mb-4">×‘×¨×•×›×™× ×”×‘××™× ×œ×”×—×‘×¨'×” ×”×˜×•×‘×™× - Ultimate Team!</h1>
      <p class="text-lg mb-6">×‘× ×• ××ª ×§×‘×•×¦×ª ×”×—×œ×•××•×ª ×©×œ×›×, ×¢× ×• ×¢×œ ×©××œ×•×ª ×˜×¨×™×•×•×™×” ×›×“×™ ×œ×”×¨×•×•×™×— ×›×¡×£, ×•× ×¡×• ×œ× ×¦×— ××ª ×›×œ ×”×‘×•×¡×™×!</p>
      <button onclick="startGame()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">×”×ª×—×œ ××©×—×§</button>
    </div>
  </div>

  <div id="team-selection-screen" class="hidden container mx-auto">
    <h1 class="text-4xl font-bold text-center mb-8">×‘×—×¨×• ××ª ×§×‘×•×¦×ª ×”×—×œ×•××•×ª</h1>
    <button onclick="selectRandomTeam()" class="block mx-auto bg-green-600 text-white px-8 py-4 rounded-lg hover:bg-green-700 transition">×‘×—×¨ ×§×‘×•×¦×” ×¨× ×“×•××œ×™×ª</button>
    <div id="team-reveal" class="flex justify-center items-center mt-8"></div>
  </div>

  <div id="main-screen" class="hidden container mx-auto">
    <h1 class="text-4xl font-bold text-center mb-8">×”×—×‘×¨'×” ×”×˜×•×‘×™× - Ultimate Team</h1>
    <div id="error" class="text-center mb-4"></div>
    <div class="mb-6 bg-gray-800 p-4 rounded-lg">
      <p class="text-xl" id="money">×›×¡×£ ×–××™×Ÿ: 1,000,000 â‚ª</p>
      <p class="text-xl" id="current-boss">×‘×•×¡ × ×•×›×—×™: ×‘×•×¡ 1 (×“×™×¨×•×’ × ×“×¨×©: 75)</p>
      <p class="text-xl" id="avg-rating">×“×™×¨×•×’ ×××•×¦×¢: 0</p>
    </div>
    <div id="team" class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"></div>
    <div class="flex justify-center gap-4">
      <button onclick="startBattle()" id="battle-btn" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">×”×ª×—×œ ×§×¨×‘</button>
      <button onclick="startTrivia()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition">×˜×¨×™×•×•×™×”</button>
      <button onclick="showTransfers()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition">×—×œ×•×Ÿ ×”×¢×‘×¨×•×ª</button>
    </div>
  </div>

  <div id="trivia-screen" class="hidden bg-gray-800 p-8 rounded-xl shadow-2xl">
    <h2 class="text-2xl font-bold mb-6" id="trivia-question"></h2>
    <div id="trivia-answers" class="grid grid-cols-1 gap-4"></div>
    <div class="mt-6 flex justify-center gap-4">
      <button onclick="nextTrivia()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">×©××œ×” ×”×‘××”</button>
      <button onclick="backToMain()" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition">×¡×’×•×¨</button>
    </div>
  </div>

  <div id="transfers-screen" class="hidden container mx-auto">
    <h2 class="text-2xl font-bold mb-6">×—×œ×•×Ÿ ×”×¢×‘×¨×•×ª</h2>
    <div id="transfers" class="grid grid-cols-1 md:grid-cols-4 gap-4"></div>
    <button onclick="backToMain()" class="mt-6 bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition">×—×–×•×¨</button>
  </div>

  <script>
    const players = [
      { name: "×¢××™×ª ×œ×¡×¨×™", role: "××™×™×¡×“ ×”×§×‘×•×¦×”", rating: 94, value: 19000000 },
      { name: "×“×‘×™×¨ ×‘×¨×§×ª", role: "×—×‘×¨", rating: 94, value: 19000000 },
      { name: "×œ×™××‘ ×‘×Ÿ ×™×¢×§×‘", role: "×—×‘×¨", rating: 86, value: 14148548.39 },
      { name: "×™×•×¡×£ ×§×—×œ×¨", role: "×× ×”×œ ×©×•×ª×£", rating: 92, value: 17817419.35 },
      { name: "××¨×™××œ ×¢×™×Ÿ ×’×œ", role: "×—×‘×¨", rating: 66, value: 1914838.71 },
      { name: "×“×‘×™×¨ ××•×—× ×”", role: "×—×‘×¨", rating: 94, value: 19000000 },
      { name: "××™×ª×™ ××•×—× ×”", role: "×—×‘×¨", rating: 92, value: 17817419.35 },
      { name: "××•×¨ ×“×”×Ÿ", role: "×—×‘×¨", rating: 81, value: 11090580.65 },
      { name: "××™×¦×™×§ ××•×¨ ×™×•×¡×£", role: "×—×‘×¨", rating: 86, value: 14148548.39 },
      { name: "× ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'", role: "×—×‘×¨", rating: 84, value: 12925016.13 },
      { name: "×§×•×¨×Ÿ × ××’×¨", role: "×—×‘×¨", rating: 77, value: 8643225.81 },
      { name: "×§×•×¨×Ÿ ×‘×Ÿ ××©×”", role: "×—×‘×¨", rating: 89, value: 15982983.87 },
      { name: "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜", role: "×—×‘×¨", rating: 89, value: 15982983.87 },
      { name: "××™×›×” ×’×•×¨×œ×•×‘×¡×§×™", role: "×—×‘×¨", rating: 90, value: 16594596.77 },
      { name: "×¢×•××¨ ×™×•×¡×£", role: "×—×‘×¨", rating: 83, value: 12313403.23 },
      { name: "×“×•×¨ ××‘×™×›×–×¨", role: "×—×‘×¨", rating: 79, value: 9866451.61 },
      { name: "××œ×™ ×™×’×•×¨×•×‘ (×§×˜×œ×˜×”)", role: "×—×‘×¨", rating: 80, value: 10478064.52 },
      { name: "×™×¢×§×‘ ×©×•×•×¨×¥", role: "×—×‘×¨", rating: 88, value: 15371370.97 },
      { name: "×™×•×’×‘ ×©×‘×ª××™", role: "×—×‘×¨", rating: 89, value: 15982983.87 },
      { name: "×—×™×™× ××¨×§×¡", role: "×—×‘×¨", rating: 85, value: 13536629.03 },
      { name: "×¨×¤×™ ××œ×’×¨×‘×œ×™", role: "×—×‘×¨", rating: 90, value: 16594596.77 },
      { name: "××¨×™××œ ×©×¨×‘×™×˜", role: "×—×‘×¨", rating: 63, value: 210000 },
    ];

    const bosses = Array.from({ length: 10 }, (_, i) => ({
      name: `×‘×•×¡ ${i + 1}`,
      requiredRating: 75 + i * 2 + (i === 9 ? 1 : 0),
    }));

    const triviaQuestions = [
      { question: "××ª×™ × ×•×¡×“×” ×§×‘×•×¦×ª ×”×•×•××˜×¡××¤ ×”×¨×©××™×ª ×©×œ ×”×—×‘×¨'×” ×”×˜×•×‘×™×?", answers: ["2009", "2010", "14 ×‘×××™ 2013", "2015"], correct: 2 },
      { question: "××™ × ×—×©×‘ ×œ××™×™×¡×“ ×”×§×‘×•×¦×”?", answers: ["×“×‘×™×¨ ××•×—× ×”", "×¢××™×ª ×œ×¡×¨×™", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜", "×§×•×¨×Ÿ ×‘×Ÿ ××©×”"], correct: 1 },
      { question: "××™ ×”×•× '×›×•×›×‘ ×”×§×‘×•×¦×”'?", answers: ["×™×•×¡×£ ×§×—×œ×¨", "×“×‘×™×¨ ××•×—× ×”", "×œ×™××‘ ×‘×Ÿ ×™×¢×§×‘", "××¨×™××œ ×¢×™×Ÿ ×’×œ"], correct: 1 },
      { question: "×›××” ×—×‘×¨×™× ××•× ×” ×§×‘×•×¦×ª ×”×•×•××˜×¡××¤ ×”×¨×©××™×ª × ×›×•×Ÿ ×œ×××™ 2025?", answers: ["18", "20", "22", "24"], correct: 2 },
      { question: "×”×™×›×Ÿ ××ª×’×•×¨×¨ ×”×—×‘×¨ ×”×™×—×™×“ ×©×—×™ ×‘×—×•\"×œ?", answers: ["×§× ×“×”", "××¨×¦×•×ª ×”×‘×¨×™×ª", "××•×¡×˜×¨×œ×™×”", "×‘×¨×™×˜× ×™×”"], correct: 1 },
      { question: "××™ ××”×—×‘×¨×™× ×œ× ×œ××“ ×‘×‘×™×ª ×”×¡×¤×¨ ××•×¨×˜ ××¢×œ×•×ª?", answers: ["×“×‘×™×¨ ×‘×¨×§×ª", "× ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'", "×™×•×¡×£ ×§×—×œ×¨", "×¢××™×ª ×œ×¡×¨×™"], correct: 1 },
      { question: "××”×• ×©× ×¡×“×¨×ª ×”×¡×¨×˜×™× ×”×™×¦×™×¨×ª×™×ª ×©×œ ×”×§×‘×•×¦×”?", answers: ["×”××§×§×™×", "×‘×œ××§×™×£", "×”×’'×•×¨×“× ×™×", "×¤×¡×˜×™×’'×™×™× ×”"], correct: 1 },
      { question: "××™ ×”×™×” ×”×—×‘×¨ ×”××‘×•×’×¨ ×‘×™×•×ª×¨ ×‘×§×‘×•×¦×” × ×›×•×Ÿ ×œ×××™ 2025?", answers: ["×¢××™×ª ×œ×¡×¨×™", "×“×‘×™×¨ ××•×—× ×”", "×™×•×¡×£ ×§×—×œ×¨", "××¨×™××œ ×¢×™×Ÿ ×’×œ"], correct: 1 },
      { question: "××”×• ×”××™×¨×•×¢ ×”××™×ª×•×œ×•×’×™ ×©×”×ª×¨×—×© ×‘-2010 ×‘×‘×¨×™×›×”?", answers: ["×ª×§×¨×™×ª ×”×¤×™×™×¡×‘×•×§", "××™×¨×•×¢×™ ×”××¡×™×™× ×“×”", "×—×©×™×¤×ª ×™×©×‘×Ÿ ×‘×”×™×›×œ ×”×ª×¨×‘×•×ª", "×ª×§×¨×™×ª ×”×“×¨×‘×•×§×”"], correct: 1 },
      { question: "××™ ×©×¤×˜ ××ª ×ª×—×¨×•×ª ×”××¡×™×™× ×“×” ×‘-2010?", answers: ["×¢××™×ª ×œ×¡×¨×™", "×“×‘×™×¨ ×‘×¨×§×ª", "×™×•×¡×£ ×§×—×œ×¨", "×§×•×¨×Ÿ ×‘×Ÿ ××©×”"], correct: 1 },
      { question: "××” ×”×™×” ×©× ×”×©×™×¨ ×‘×¡×¨×˜×•×Ÿ ×”×ª×¢××•×œ×” × ×’×“ ×™×•×¡×£ ×§×—×œ×¨ ×‘-2010?", answers: ["×× ×™ ×™×œ×“, ×™×œ×“ ××˜×•××˜×", "××›×” ××¤×•×¨×”", "×œ×š ×ª×–×“×™×™×Ÿ, ×× ×™ ××¨×•×§××™", "×”×•× ×–×™×™×Ÿ, ×”×•× ×¡×™×™×"], correct: 0 },
      { question: "××™ ×”×’×™×‘ ×‘××©×¤×˜ '×œ×š ×ª×–×“×™×™×Ÿ, ×× ×™ ×‘×›×œ×œ ××¨×•×§××™' ×‘×ª×§×¨×™×ª ×”×“×¨×‘×•×§×”?", answers: ["×¤×œ×’ ×¡×‘×’", "×©×—×¨ ××œ××§×™×™×¡", "×¢××™×ª ×œ×¡×¨×™", "×“×‘×™×¨ ××•×—× ×”"], correct: 1 },
      { question: "××”×• ×”××™×¨×•×¢ ×©×”×¤×š ××ª ×”×—×‘×¨'×” ×”×˜×•×‘×™× ×œ×™×“×•×¢×™× ×‘-2009?", answers: ["×ª×§×¨×™×ª ×”×¤×™×™×¡×‘×•×§", "×ª×§×¨×™×ª ×‘××“×‘×¨", "×‘×¨ ×”××¦×•×•×” ×©×œ ×“×‘×™×¨ ××•×—× ×”", "×ª×—×¨×•×ª ×›×™×©×¨×•× ×•×ª"], correct: 0 },
      { question: "××™ × ×¤×¦×¢ ××¤×’×™×¢×ª ×ª×¤×•×— ×‘-2011?", answers: ["×¢××™×ª ×œ×¡×¨×™", "××¡×£ ××¨×¦×™×× ×•", "××™×›×” ×’×•×¨×œ×•×‘×¡×§×™", "× ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'"], correct: 1 },
      { question: "××” ×”×™×” ×”××™×¨×•×¢ ×”××‘×™×š ×‘×™×•×ª×¨ ×‘×ª×•×œ×“×•×ª × ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'?", answers: ["×ª×§×¨×™×ª ×‘××¦×œ××•×ª", "×¡×¨×˜×•×Ÿ ×”××•× × ×•×ª", "×–×¨×™×§×ª ××‘× ×™× ×¢×œ ×œ×™×œ×™×”", "××™×•× ×¢×œ ×¢×™×ª×•× ××™"], correct: 0 },
      { question: "×‘××™×–×• ×©× ×” ×”×—×œ×” ××¡×•×¨×ª '×‘×Ÿ ×–×•× ×” ×©×œ ×”×©× ×”'?", answers: ["2017", "2018", "2019", "2020"], correct: 2 },
      { question: "××™ ×–×›×” ×‘×ª×•××¨ '×‘×Ÿ ×–×•× ×” ×©×œ ×”×©× ×”' ×‘-2019?", answers: ["×¢××™×ª ×œ×¡×¨×™", "×™×•×¡×£ ×§×—×œ×¨", "×“×‘×™×¨ ××•×—× ×”", "×“×‘×™×¨ ×‘×¨×§×ª"], correct: 1 },
      { question: "××” ×”×™×” ×”××™×¨×•×¢ ×”××¨×›×–×™ ×‘××¡×™×‘×ª ×œ\"×’ ×‘×¢×•××¨ 2 ×‘-2014?", answers: ["×’× ×™×‘×ª ×’× ×¨×˜×•×¨", "×©×™×“×•×¨ ××©×—×§ ×©×œ ××›×‘×™ ×ª×œ ××‘×™×‘", "×ª×§×¨×™×ª ××œ×™××•×ª", "××ª×™×—×ª ×”×¦×•××”"], correct: 1 },
      { question: "××™ ×”×¦×™×œ ××ª ×—×™×™× ××¨×§×¡ ××˜×‘×™×¢×” ×‘× ×—×œ ×›×–×™×‘ ×‘-2014?", answers: ["×“×‘×™×¨ ××•×—× ×”", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜", "×¢××™×ª ×œ×¡×¨×™", "×™×•×¡×£ ×§×—×œ×¨"], correct: 1 },
      { question: "××”×• ×©× ×”××©×—×§ ×©×‘×• ××™×›×” ×’×•×¨×œ×•×‘×¡×§×™ ×”×•×¨×™×“ ××ª ××›× ×¡×™×• ×‘-2014?", answers: ["×”××— ×”×’×“×•×œ", "×¤×¨×” ×¢×™×•×•×¨×ª", "×ª×—×¨×•×ª ×›×™×©×¨×•× ×•×ª", "××ª×™×—×ª ×”×¦×•××”"], correct: 1 },
      { question: "××™ ×”×™×• ×—×‘×¨×™ '××©×•×œ×© ×”×¨×©×¢'?", answers: ["×¢××™×ª ×œ×¡×¨×™, ×“×‘×™×¨ ××•×—× ×”, ×™×•×¡×£ ×§×—×œ×¨", "×“×‘×™×¨ ×‘×¨×§×ª, ×™×•×¡×£ ×§×—×œ×¨, ××™×¦×™×§ ××•×¨ ×™×•×¡×£", "×œ×™××‘ ×‘×Ÿ ×™×¢×§×‘, ×§×•×¨×Ÿ × ××’×¨, ××¨×™××œ ×¢×™×Ÿ ×’×œ", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜, ×™×¢×§×‘ ×©×•×•×¨×¥, ××™×ª×™ ××•×—× ×”"], correct: 1 },
      { question: "××™×–×” ×—×‘×¨ ×”×¤×š ×œ××‘ ×œ×¨××©×•× ×” ×‘-2024?", answers: ["×¢××™×ª ×œ×¡×¨×™", "× ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'", "×™×•×¡×£ ×§×—×œ×¨", "×“×‘×™×¨ ××•×—× ×”"], correct: 1 },
      { question: "×‘××™×–×• ×¢×™×¨ ×”×ª×§×™×™××” ××¡×™×‘×ª ×”×¨×•×•×§×™× ×©×œ ×™×¢×§×‘ ×©×•×•×¨×¥ ×‘-2025?", answers: ["×‘×¨×œ×™×Ÿ", "×××¡×˜×¨×“×", "×§×¤×¨×™×¡×™×Ÿ", "×‘×•×¨×’×¡"], correct: 2 },
      { question: "××™ ×™×¦×¨ ××ª ×¡×“×¨×ª ×”×¡×¨×˜×™× ×‘×œ××§×™×£?", answers: ["×¢××™×ª ×œ×¡×¨×™", "×“×‘×™×¨ ×‘×¨×§×ª", "××™×ª×™ ××•×—× ×”", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜"], correct: 1 },
      { question: "××”×• ××•×¨×›×• ×©×œ ×”×¡×¨×˜ ×”××¨×•×š ×‘×™×•×ª×¨ ×‘×¡×“×¨×ª ×‘×œ××§×™×£?", answers: ["1:28 ×“×§×•×ª", "2:39 ×“×§×•×ª", "5:15 ×“×§×•×ª", "6:45 ×“×§×•×ª"], correct: 3 },
      { question: "××™ ×©×™×—×§ ×›×—×¨×“×™ ××—×¡×™×“×•×ª ×•×™×–'× ×¥ ×‘×‘×œ××§×™×£ 5?", answers: ["×“×‘×™×¨ ××•×—× ×”", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜", "××™×ª×™ ××•×—× ×”", "×¢××™×ª ×œ×¡×¨×™"], correct: 1 },
      { question: "××” ×”×™×” ×ª×¤×§×™×“×• ×©×œ ××™×¦×™×§ ××•×¨ ×™×•×¡×£ ×‘×‘×œ××§×™×£ 4?", answers: ["×—×§×œ××™", "×œ×•×—× ×—×¨×“×™", "××™×© ×‘×××œ×›×”", "×¨××¤×¨"], correct: 2 },
      { question: "××™×–×” ××™×¨×•×¢ ××©××¢×•×ª×™ ×”×ª×¨×—×© ×‘-7 ×‘××•×§×˜×•×‘×¨ 2023?", answers: ["×—×ª×•× ×ª ×¢×•××¨ ×™×•×¡×£", "××¨×™××œ ×¢×™×Ÿ ×’×œ ×”×™×” ×¢×“ ×œ×˜×‘×— ×‘×—×•×£ ×–×™×§×™×", "×¤×™×’×•×¢ ×™×¨×™ ×‘×™×¤×•", "××¡×™×‘×ª ×”×¨×•×•×§×™× ×©×œ ×™×¢×§×‘ ×©×•×•×¨×¥"], correct: 1 },
      { question: "××”×• ×”×›×™× ×•×™ ×©×œ × ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥' ×‘×§×‘×•×¦×”?", answers: ["×”×•×•×˜×¨×Ÿ", "××©×•×œ×© ×”×¨×©×¢", "×›×•×›×‘ ×”×§×‘×•×¦×”", "×”××§×§×™×"], correct: 0 },
      { question: "××™×–×• ×‘×“×™×—×” ×—×•×–×¨×ª ×§×©×•×¨×” ×œ×©×—×¨ ××œ××§×™×™×¡?", answers: ["×”×•× ×–×™×™×Ÿ, ×”×•× ×¡×™×™×", "×œ×š ×ª×–×“×™×™×Ÿ, ×× ×™ ×‘×›×œ×œ ××¨×•×§××™", "×§×¢×§×•×¢×™× ×©×œ ×•×× ×¡", "×× ×™ ×™×œ×“, ×™×œ×“ ××˜×•××˜×"], correct: 1 },
    ];

    let team = [];
    let money = 1000000;
    let currentBoss = 0;
    let currentTrivia = null;

    function getStars(rating) {
      if (rating >= 94) return 'â˜…â˜…â˜…â˜…â˜…';
      if (rating >= 85) return 'â˜…â˜…â˜…â˜…';
      if (rating >= 76) return 'â˜…â˜…â˜…';
      if (rating >= 64) return 'â˜…â˜…';
      return 'â˜…';
    }

    function shootConfetti() {
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 },
      });
    }

    function init() {
      try {
        const savedTeam = localStorage.getItem("team");
        const savedMoney = localStorage.getItem("money");
        const savedBoss = localStorage.getItem("currentBoss");
        team = savedTeam ? JSON.parse(savedTeam) : [];
        money = savedMoney ? parseInt(savedMoney) : 1000000;
        currentBoss = savedBoss ? parseInt(savedBoss) : 0;
        if (team.length === 5) {
          showMainScreen();
        } else {
          showTeamSelectionScreen();
        }
        updateUI();
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×¢×™× ×ª ×”××©×—×§: " + e.message);
      }
    }

    function showError(message) {
      document.getElementById("error").style.display = "block";
      document.getElementById("error").innerText = message;
    }

    function getRandomTeam() {
      const shuffled = [...players].sort(() => Math.random() - 0.5);
      return shuffled.slice(0, 5);
    }

    function calculateAverageRating() {
      if (team.length === 0) return 0;
      return team.reduce((sum, player) => sum + player.rating, 0) / team.length;
    }

    function startGame() {
      document.getElementById("welcome-screen").classList.add("hidden");
      document.getElementById("team-selection-screen").classList.remove("hidden");
    }

    function showTeamSelectionScreen() {
      document.getElementById("main-screen").classList.add("hidden");
      document.getElementById("team-selection-screen").classList.remove("hidden");
      document.getElementById("trivia-screen").classList.add("hidden");
      document.getElementById("transfers-screen").classList.add("hidden");
    }

    function showMainScreen() {
      document.getElementById("main-screen").classList.remove("hidden");
      document.getElementById("team-selection-screen").classList.add("hidden");
      document.getElementById("trivia-screen").classList.add("hidden");
      document.getElementById("transfers-screen").classList.add("hidden");
      updateUI();
    }

    function selectRandomTeam() {
      team = getRandomTeam();
      localStorage.setItem("team", JSON.stringify(team));
      const teamRevealDiv = document.getElementById("team-reveal");
      teamRevealDiv.innerHTML = "";
      team.forEach((player, index) => {
        setTimeout(() => {
          teamRevealDiv.innerHTML = "";
          const card = document.createElement("div");
          card.className = `player-card p-6 rounded-xl shadow-lg player-reveal ${player.rating >= 90 ? 'dance' : ''}`;
          card.innerHTML = `<div class="text-center"><span class="text-4xl">ğŸ‡®ğŸ‡±</span></div>`;
          teamRevealDiv.appendChild(card);
          setTimeout(() => {
            card.innerHTML = `
              <div class="text-center">
                <span class="text-4xl">ğŸ‡®ğŸ‡±</span>
                <p class="text-2xl font-bold mt-4">${player.rating}</p>
                <p class="star text-2xl">${getStars(player.rating)}</p>
              </div>
            `;
            if (player.rating >= 90) shootConfetti();
          }, 1000);
          setTimeout(() => {
            card.innerHTML = `
              <div class="text-center">
                <span class="text-4xl">ğŸ‡®ğŸ‡±</span>
                <h2 class="text-xl font-bold mt-4">${player.name}</h2>
                <p>×ª×¤×§×™×“: ${player.role}</p>
                <p>×“×™×¨×•×’: ${player.rating}</p>
                <p class="star">${getStars(player.rating)}</p>
                <p>×©×•×•×™: ${player.value.toLocaleString()} â‚ª</p>
              </div>
            `;
            if (index === team.length - 1) {
              setTimeout(() => {
                alert("×–×• ×”×—××™×©×™×™×” ×©×œ×›×! ×‘×”×¦×œ×—×”! ×‘×”××©×š ×ª×•×›×œ×• ×œ××›×•×¨ ×•×œ×§× ×•×ª ×©×—×§× ×™×, ×œ×¢× ×•×ª ×¢×œ ×˜×¨×™×•×•×™×” ×›×“×™ ×œ×”×¨×•×•×™×— ×›×¡×£, ×•×œ× ×¦×— ××ª ×”×‘×•×¡×™×!");
                showMainScreen();
              }, 1000);
            }
          }, 2000);
        }, index * 3000);
      });
    }

    function updateUI() {
      try {
        document.getElementById("money").innerText = `×›×¡×£ ×–××™×Ÿ: ${money.toLocaleString()} â‚ª`;
        document.getElementById("current-boss").innerText = `×‘×•×¡ × ×•×›×—×™: ${bosses[currentBoss].name} (×“×™×¨×•×’ × ×“×¨×©: ${bosses[currentBoss].requiredRating})`;
        document.getElementById("avg-rating").innerText = `×“×™×¨×•×’ ×××•×¦×¢: ${calculateAverageRating().toFixed(1)}`;
        document.getElementById("battle-btn").disabled = team.length !== 5;

        const teamDiv = document.getElementById("team");
        teamDiv.innerHTML = "";
        team.forEach((player, index) => {
          const card = document.createElement("div");
          card.className = "card bg-gray-900 p-4 rounded-xl shadow-lg";
          card.innerHTML = `
            <div class="text-center">
              <span class="text-2xl">ğŸ‡®ğŸ‡±</span>
              <h2 class="text-xl font-bold mt-2">${player.name}</h2>
              <p>×ª×¤×§×™×“: ${player.role}</p>
              <p>×“×™×¨×•×’: ${player.rating}</p>
              <p class="star">${getStars(player.rating)}</p>
              <p>×©×•×•×™: ${player.value.toLocaleString()} â‚ª</p>
              <button onclick="sellPlayer(${index})" class="mt-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition">××›×•×¨</button>
            </div>
          `;
          teamDiv.appendChild(card);
        });
      } catch (e) {
        showError("×©×’×™××” ×‘×¢×“×›×•×Ÿ ×××©×§: " + e.message);
      }
    }

    function startBattle() {
      try {
        if (team.length !== 5) {
          alert("×—×™×™×‘×™× 5 ×©×—×§× ×™× ×›×“×™ ×œ×”×™×œ×—×!");
          return;
        }
        const avgRating = calculateAverageRating();
        const required = bosses[currentBoss].requiredRating;
        if (avgRating >= required) {
          money += 1000000;
          alert(`× ×™×¦×—×ª ××ª ${bosses[currentBoss].name}! ×”×¨×•×•×—×ª 1,000,000 â‚ª!`);
          currentBoss = Math.min(currentBoss + 1, bosses.length - 1);
          shootConfetti();
        } else {
          alert(`×”×¤×¡×“×ª! ×”×“×™×¨×•×’ ×”×××•×¦×¢ ×©×œ×š (${avgRating.toFixed(1)}) × ××•×š ××“×¨×™×©×ª ×”×‘×•×¡ (${required}).`);
          team = [];
          money = 1000000;
          currentBoss = 0;
          showTeamSelectionScreen();
        }
        localStorage.setItem("team", JSON.stringify(team));
        localStorage.setItem("money", money);
        localStorage.setItem("currentBoss", currentBoss);
        updateUI();
      } catch (e) {
        showError("×©×’×™××” ×‘×§×¨×‘: " + e.message);
      }
    }

    function startTrivia() {
      try {
        currentTrivia = triviaQuestions[Math.floor(Math.random() * triviaQuestions.length)];
        document.getElementById("main-screen").classList.add("hidden");
        document.getElementById("trivia-screen").classList.remove("hidden");
        document.getElementById("trivia-question").innerText = currentTrivia.question;
        const answersDiv = document.getElementById("trivia-answers");
        answersDiv.innerHTML = "";
        currentTrivia.answers.forEach((answer, index) => {
          const button = document.createElement("button");
          button.className = "p-4 rounded-lg bg-gray-700 hover:bg-gray-600 transition";
          button.innerText = answer;
          button.onclick = () => handleTriviaAnswer(index);
          answersDiv.appendChild(button);
        });
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×¢×™× ×ª ×˜×¨×™×•×•×™×”: " + e.message);
      }
    }

    function handleTriviaAnswer(index) {
      try {
        if (index === currentTrivia.correct) {
          money += 50000;
          alert("×ª×©×•×‘×” × ×›×•× ×”! ×”×¨×•×•×—×ª 50,000 â‚ª!");
          shootConfetti();
        } else {
          alert("×ª×©×•×‘×” ×©×’×•×™×”, × ×¡×” ×©×•×‘!");
        }
        localStorage.setItem("money", money);
        nextTrivia();
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×™×¤×•×œ ×‘×ª×©×•×‘×ª ×˜×¨×™×•×•×™×”: " + e.message);
      }
    }

    function nextTrivia() {
      try {
        currentTrivia = triviaQuestions[Math.floor(Math.random() * triviaQuestions.length)];
        document.getElementById("trivia-question").innerText = currentTrivia.question;
        const answersDiv = document.getElementById("trivia-answers");
        answersDiv.innerHTML = "";
        currentTrivia.answers.forEach((answer, index) => {
          const button = document.createElement("button");
          button.className = "p-4 rounded-lg bg-gray-700 hover:bg-gray-600 transition";
          button.innerText = answer;
          button.onclick = () => handleTriviaAnswer(index);
          answersDiv.appendChild(button);
        });
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×¢×™× ×ª ×©××œ×” ×—×“×©×”: " + e.message);
      }
    }

    function showTransfers() {
      try {
        document.getElementById("main-screen").classList.add("hidden");
        document.getElementById("transfers-screen").classList.remove("hidden");
        const transfersDiv = document.getElementById("transfers");
        transfersDiv.innerHTML = "";
        players.forEach((player) => {
          const card = document.createElement("div");
          card.className = "card bg-gray-900 p-4 rounded-xl shadow-lg";
          card.innerHTML = `
            <div class="text-center">
              <span class="text-2xl">ğŸ‡®ğŸ‡±</span>
              <h2 class="text-xl font-bold mt-2">${player.name}</h2>
              <p>×ª×¤×§×™×“: ${player.role}</p>
              <p>×“×™×¨×•×’: ${player.rating}</p>
              <p class="star">${getStars(player.rating)}</p>
              <p>×©×•×•×™: ${player.value.toLocaleString()} â‚ª</p>
              <button onclick="buyPlayer('${player.name}')" class="mt-2 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition" ${
                team.some((p) => p.name === player.name) || team.length >= 5 ? "disabled" : ""
              }>×§× ×”</button>
            </div>
          `;
          transfersDiv.appendChild(card);
        });
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×¢×™× ×ª ×—×œ×•×Ÿ ×”×¢×‘×¨×•×ª: " + e.message);
      }
    }

    function buyPlayer(playerName) {
      try {
        const player = players.find((p) => p.name === playerName);
        if (money >= player.value) {
          money -= player.value;
          team.push(player);
          localStorage.setItem("team", JSON.stringify(team));
          localStorage.setItem("money", money);
          alert(`×¨×›×©×ª ××ª ${player.name}!`);
          if (player.rating >= 90) shootConfetti();
          showTransfers();
          updateUI();
        } else {
          alert("××™×Ÿ ××¡×¤×™×§ ×›×¡×£!");
        }
      } catch (e) {
        showError("×©×’×™××” ×‘×¨×›×™×©×ª ×©×—×§×Ÿ: " + e.message);
      }
    }

    function sellPlayer(index) {
      try {
        money += team[index].value;
        team.splice(index, 1);
        localStorage.setItem("team", JSON.stringify(team));
        localStorage.setItem("money", money);
        alert("×©×—×§×Ÿ × ××›×¨!");
        updateUI();
      } catch (e) {
        showError("×©×’×™××” ×‘××›×™×¨×ª ×©×—×§×Ÿ: " + e.message);
      }
    }

    function backToMain() {
      try {
        if (team.length === 0) {
          showTeamSelectionScreen();
        } else {
          showMainScreen();
        }
      } catch (e) {
        showError("×©×’×™××” ×‘×—×–×¨×” ×œ××¡×š ×”×¨××©×™: " + e.message);
      }
    }

    window.onload = init;
  </script>
</body>
</html>
