<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>×”×—×‘×¨'×” ×”×˜×•×‘×™× - Ultimate Team</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideIn { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    @keyframes dance {
      0% { transform: rotate(0deg) scale(1); }
      25% { transform: rotate(10deg) scale(1.1); }
      50% { transform: rotate(0deg) scale(1); }
      75% { transform: rotate(-10deg) scale(1.1); }
      100% { transform: rotate(0deg) scale(1); }
    }
    body { font-family: 'Arial', sans-serif; direction: rtl; background: linear-gradient(to bottom, #1a202c, #2d3748); color: white; }
    .card { transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3); }
    .star { color: #FFD700; }
    .popup { animation: fadeIn 0.5s ease-in-out; }
    .player-reveal { animation: slideIn 0.5s ease-in-out; }
    .dance { animation: dance 0.8s infinite; }
    #error { display: none; color: #fc8181; }
    .player-card { background: linear-gradient(135deg, #4b5e7e, #2d3748); border: 2px solid #FFD700; }
    .team-popup { background: linear-gradient(135deg, #1a202c, #4a5568); border: 4px solid #FFD700; }
    .battle-popup { background: linear-gradient(135deg, #4a0000, #8b0000); border: 4px solid #FFD700; }
    .dropdown-menu { background: #2d3748; }
  </style>
</head>
<body class="min-h-screen p-4">
  <div id="welcome-screen" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
    <div class="bg-gray-800 p-8 rounded-xl shadow-2xl max-w-md w-full text-center popup">
      <h1 class="text-3xl font-bold mb-4">×‘×¨×•×›×™× ×”×‘××™× ×œ×”×—×‘×¨'×” ×”×˜×•×‘×™× - Ultimate Team!</h1>
      <p class="text-lg mb-6">×¦×¨×• ××ª ×§×‘×•×¦×ª ×”×—×œ×•××•×ª, ×”×¨×•×•×™×—×• ×›×¡×£ ×‘×˜×¨×™×•×•×™×”, ×•×©×¤×¨×• ××ª ×”×©×—×§× ×™× ×›×“×™ ×œ× ×¦×— ××ª ×”×‘×•×¡×™×!</p>
      <button onclick="startGame()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">×”×ª×—×œ ××©×—×§</button>
    </div>
  </div>

  <div id="team-selection-screen" class="hidden container mx-auto">
    <h1 class="text-4xl font-bold text-center mb-8">×‘×—×¨×• ××ª ×§×‘×•×¦×ª ×”×—×œ×•××•×ª</h1>
    <button onclick="selectRandomTeam()" class="block mx-auto bg-green-600 text-white px-8 py-4 rounded-lg hover:bg-green-700 transition">×‘×—×¨ ×§×‘×•×¦×” ×¨× ×“×•××œ×™×ª</button>
    <div id="team-reveal" class="grid grid-cols-1 md:grid-cols-5 gap-4 mt-8"></div>
  </div>

  <div id="team-popup" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
    <div class="team-popup p-8 rounded-xl shadow-2xl max-w-2xl w-full text-center popup">
      <h1 class="text-3xl font-bold mb-4">×”×—××™×©×™×™×” ×©×œ×›× ××•×›× ×”!</h1>
      <p class="text-lg mb-6">×”×¨×›×‘×ª× ××ª ×§×‘×•×¦×ª ×”×—×œ×•××•×ª! ×”×©×ª××©×• ×‘×˜×¨×™×•×•×™×” ×œ×”×¨×•×•×™×— ×›×¡×£, ×©×¤×¨×• ×©×—×§× ×™×, ×•×¦××• ×œ×§×¨×‘ × ×’×“ ×”×‘×•×¡×™×!</p>
      <button onclick="showMainScreen()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">×”××©×š ×œ××©×—×§</button>
    </div>
  </div>

  <div id="battle-popup" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
    <div class="battle-popup p-8 rounded-xl shadow-2xl max-w-2xl w-full text-center popup">
      <h1 class="text-3xl font-bold mb-4" id="battle-title"></h1>
      <p class="text-lg mb-6" id="battle-description"></p>
      <button onclick="proceedToBattle()" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition">×”×ª×—×œ ×§×¨×‘!</button>
    </div>
  </div>

  <div id="main-screen" class="hidden container mx-auto">
    <h1 class="text-4xl font-bold text-center mb-8">×”×—×‘×¨'×” ×”×˜×•×‘×™× - Ultimate Team</h1>
    <div id="error" class="text-center mb-4"></div>
    <div class="mb-6 bg-gray-800 p-4 rounded-lg">
      <p class="text-xl" id="money">×›×¡×£ ×–××™×Ÿ: 1,000,000 â‚ª</p>
      <p class="text-xl" id="current-boss">×‘×•×¡ × ×•×›×—×™: ×‘×•×¡ 1 (×“×™×¨×•×’ × ×“×¨×©: 75)</p>
      <p class="text-xl" id="avg-rating">×“×™×¨×•×’ ×××•×¦×¢: 0</p>
    </div>
    <div id="team" class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"></div>
    <div class="flex justify-center gap-4">
      <button onclick="showBattlePopup()" id="battle-btn" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">×”×ª×—×œ ×§×¨×‘</button>
      <button onclick="startTrivia()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition">×˜×¨×™×•×•×™×”</button>
      <button onclick="showTransfers()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition">×—×œ×•×Ÿ ×”×¢×‘×¨×•×ª</button>
    </div>
  </div>

  <div id="trivia-screen" class="hidden bg-gray-800 p-8 rounded-xl shadow-2xl">
    <h2 class="text-2xl font-bold mb-6" id="trivia-question"></h2>
    <div id="trivia-answers" class="grid grid-cols-1 gap-4"></div>
    <div class="mt-6 flex justify-center gap-4">
      <button onclick="nextTrivia()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">×©××œ×” ×”×‘××”</button>
      <button onclick="backToMain()" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition">×¡×’×•×¨</button>
    </div>
  </div>

  <div id="transfers-screen" class="hidden container mx-auto">
    <h2 class="text-2xl font-bold mb-6">×—×œ×•×Ÿ ×”×¢×‘×¨×•×ª</h2>
    <div id="transfers" class="grid grid-cols-1 md:grid-cols-4 gap-4"></div>
    <button onclick="backToMain()" class="mt-6 bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition">×—×–×•×¨</button>
  </div>

  <script>
    const players = [
      { name: "×¢××™×ª ×œ×¡×¨×™", role: "××™×™×¡×“ ×”×§×‘×•×¦×”", rating: 94, value: 19000000, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×“×‘×™×¨ ×‘×¨×§×ª", role: "×—×‘×¨", rating: 94, value: 19000000, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×œ×™××‘ ×‘×Ÿ ×™×¢×§×‘", role: "×—×‘×¨", rating: 86, value: 14148548.39, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×™×•×¡×£ ×§×—×œ×¨", role: "×× ×”×œ ×©×•×ª×£", rating: 92, value: 17817419.35, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "××¨×™××œ ×¢×™×Ÿ ×’×œ", role: "×—×‘×¨", rating: 66, value: 1914838.71, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×“×‘×™×¨ ××•×—× ×”", role: "×—×‘×¨", rating: 94, value: 19000000, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "××™×ª×™ ××•×—× ×”", role: "×—×‘×¨", rating: 92, value: 17817419.35, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "××•×¨ ×“×”×Ÿ", role: "×—×‘×¨", rating: 81, value: 11090580.65, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "××™×¦×™×§ ××•×¨ ×™×•×¡×£", role: "×—×‘×¨", rating: 86, value: 14148548.39, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "× ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'", role: "×—×‘×¨", rating: 84, value: 12925016.13, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×§×•×¨×Ÿ × ××’×¨", role: "×—×‘×¨", rating: 77, value: 8643225.81, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×§×•×¨×Ÿ ×‘×Ÿ ××©×”", role: "×—×‘×¨", rating: 89, value: 15982983.87, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜", role: "×—×‘×¨", rating: 89, value: 15982983.87, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "××™×›×” ×’×•×¨×œ×•×‘×¡×§×™", role: "×—×‘×¨", rating: 90, value: 16594596.77, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×¢×•××¨ ×™×•×¡×£", role: "×—×‘×¨", rating: 83, value: 12313403.23, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×“×•×¨ ××‘×™×›×–×¨", role: "×—×‘×¨", rating: 79, value: 9866451.61, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "××œ×™ ×™×’×•×¨×•×‘ (×§×˜×œ×˜×”)", role: "×—×‘×¨", rating: 80, value: 10478064.52, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×™×¢×§×‘ ×©×•×•×¨×¥", role: "×—×‘×¨", rating: 88, value: 15371370.97, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×™×•×’×‘ ×©×‘×ª××™", role: "×—×‘×¨", rating: 89, value: 15982983.87, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×—×™×™× ××¨×§×¡", role: "×—×‘×¨", rating: 85, value: 13536629.03, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "×¨×¤×™ ××œ×’×¨×‘×œ×™", role: "×—×‘×¨", rating: 90, value: 16594596.77, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
      { name: "××¨×™××œ ×©×¨×‘×™×˜", role: "×—×‘×¨", rating: 63, value: 210000, health: 100, upgradeCount: 0, stageUpgradeCount: 0 },
    ];

    const bosses = [
      { name: "××•×¨×™××œ ×–×’×•×¨×™", requiredRating: 75, description: "××ª× ×‘×××¦×¢ ×”×§×¨×‘ ×©×œ ×™×•×¡×£ ×§×—×œ×¨ ×•××•×¨×™××œ ×–×’×•×¨×™, ×¢×–×¨×• ×œ×• ×œ×”×œ×—× ×•×œ×”×‘×™×¡ ××ª ××•×¨×™××œ ×–×’×•×¨×™" },
      { name: "×˜×•×‘×™×” ×•×—×“×•×•×”", requiredRating: 77, description: "×˜×•×‘×™×” ×•×—×“×•×•×” ×–×•×¢××™× ×¢×œ ×”×¨×¢×© ×©×¢×©×™×ª× ×œ×”×, ×”×‘×Ÿ ××“× ×©×œ×”× ×™×¦× ×œ×”×œ×—× ×™×—×“ ××™×ª×, ×”×œ×—××• ×‘×”×" },
      { name: "×œ×™×˜×œ ××‘×•×˜×‘×•×œ", requiredRating: 79, description: "×™×•×¡×£ ×§×—×œ×¨ ×¨×‘ ××›×•×ª ×¢× ×œ×™×˜×œ, ×œ×™×˜×œ × ×¤×œ×” ×•×”×‘×™××” ××ª ×›×œ ×”×‘×—×¨×•×ª ×©×œ×” ×ª×¢×–×¨×• ×œ×™×•×¡×£" },
      { name: "×§×¨×Ÿ ×¤×•××¨× ×¥", requiredRating: 81, description: "×§×¨×Ÿ ×¤×•××¨× ×¥ ××¨×‘×™×¦×” ×œ×¢××™×ª ×œ×¡×¨×™, ×œ×¡×¨×™ ×œ×§×¨××ª ×”×ª×¢×œ×¤×•×ª, ×ª×—×–×™×¨×• ××ª ×”×›×‘×•×“ ×”××‘×•×“" },
      { name: "×“×™×Ÿ ×›×“×•×¨×™", requiredRating: 83, description: "×‘×Ÿ ×“×•×“ ×©×œ ×¨×¤×™ ×¨×•×¦×” ×œ×”×¦×˜×¨×£ ×œ×—×‘×¨×³×” ×”×˜×•×‘×™×, ×ª×”×¨×’×• ××•×ª×•" },
      { name: "× ×˜×¢ ×‘× ×’×³×•", requiredRating: 85, description: "× ×˜×¢ ×‘× ×’×³×• ×©××¢×” ××ª ×”×—×‘×¨×³×” ×”×˜×•×‘×™× ×¦×•×—×§×™× ×¢×œ ×™×•×¡×£ ××—×¨×™ ×©×”× ×©×›×‘×•, ×”×™× ×›×•×¢×¡×ª, ×ª×”×¨×’×• ××•×ª×” ×‘×ª×—×ª" },
      { name: "×—×‘×•×¨×” ××˜×‘×¨×™×”", requiredRating: 87, description: "×—×‘×•×¨×” ××˜×‘×¨×™×” ×‘××¡×™×‘×” ×‘×¨××ª ×™×©×™ ×¢× ×¦×™× ×•×¨×•×ª ×¢×¦×‘× ×™×™× ×¢×œ ×¨×¤×™ ×•×¨×‘×™× ××›×•×ª ×¢× ×”×—×‘×¨×³×”, ×–×• ×”×”×–×“×× ×•×ª ×œ×”×—×–×™×¨ ×œ×”× ××—×ª ×•×œ×ª××™×“" },
      { name: "×•×¨×“ ×¢×™×Ÿ ×’×œ", requiredRating: 89, description: "×•×¨×“ ××¢×•× ×™×™× ×ª ×œ×˜×•×¡ ×œ×§×•×¨×™××” ×©×•×‘, ×ª×¢×©×• ×˜×•×‘×” ×œ×¢×•×œ× ×•×ª×¢×¦×¨×• ××ª ×–×”" },
      { name: "×©×—×¨ ××œ××§×™×™×¡", requiredRating: 91, description: "×©×—×¨ ×× ×’×Ÿ ×¢×œ ×“×¨×‘×•×§×” ×•××©×—×§ ××•×ª×” ×ª×™×× ×™, ×ª×¢×–×¨×• ×œ×• ×œ×”×‘×™×Ÿ ×©×”×•× ××¨×•×§××™" },
      { name: "×¢×•××¨×™ ×§×¨×¡× ×˜×™", requiredRating: 93, description: "×¢×•××¨×™ ×¨×•×¦×” ×œ× ×§×•× ×¢×œ ×›×œ ×”×”×ª×‘×¨×™×™× ×•×ª ×•×”×”×¦×§×•×ª ×•×”××ª×™×—×•×ª, ×”×•× ×—×–×§ ×××™ ×¤×¢×, × ×¦×—×• ××•×ª×•" },
    ];

    const triviaQuestions = [
      { question: "××ª×™ × ×•×¡×“×” ×§×‘×•×¦×ª ×”×•×•××˜×¡××¤ ×”×¨×©××™×ª ×©×œ ×”×—×‘×¨'×” ×”×˜×•×‘×™×?", answers: ["2009", "2010", "14 ×‘×××™ 2013", "2015"], correct: 2 },
      { question: "××™ × ×—×©×‘ ×œ××™×™×¡×“ ×”×§×‘×•×¦×”?", answers: ["×“×‘×™×¨ ××•×—× ×”", "×¢××™×ª ×œ×¡×¨×™", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜", "×§×•×¨×Ÿ ×‘×Ÿ ××©×”"], correct: 1 },
      { question: "××™ ×”×•× '×›×•×›×‘ ×”×§×‘×•×¦×”'?", answers: ["×™×•×¡×£ ×§×—×œ×¨", "×“×‘×™×¨ ××•×—× ×”", "×œ×™××‘ ×‘×Ÿ ×™×¢×§×‘", "××¨×™××œ ×¢×™×Ÿ ×’×œ"], correct: 1 },
      { question: "×›××” ×—×‘×¨×™× ××•× ×” ×§×‘×•×¦×ª ×”×•×•××˜×¡××¤ ×”×¨×©××™×ª × ×›×•×Ÿ ×œ×××™ 2025?", answers: ["18", "20", "22", "24"], correct: 2 },
      { question: "×”×™×›×Ÿ ××ª×’×•×¨×¨ ×”×—×‘×¨ ×”×™×—×™×“ ×©×—×™ ×‘×—×•\"×œ?", answers: ["×§× ×“×”", "××¨×¦×•×ª ×”×‘×¨×™×ª", "××•×¡×˜×¨×œ×™×”", "×‘×¨×™×˜× ×™×”"], correct: 1 },
      { question: "××™ ××”×—×‘×¨×™× ×œ× ×œ××“ ×‘×‘×™×ª ×”×¡×¤×¨ ××•×¨×˜ ××¢×œ×•×ª?", answers: ["×“×‘×™×¨ ×‘×¨×§×ª", "× ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'", "×™×•×¡×£ ×§×—×œ×¨", "×¢××™×ª ×œ×¡×¨×™"], correct: 1 },
      { question: "××”×• ×©× ×¡×“×¨×ª ×”×¡×¨×˜×™× ×”×™×¦×™×¨×ª×™×ª ×©×œ ×”×§×‘×•×¦×”?", answers: ["×”××§×§×™×", "×‘×œ××§×™×£", "×”×’'×•×¨×“× ×™×", "×¤×¡×˜×™×’'×™×™× ×”"], correct: 1 },
      { question: "××™ ×”×™×” ×”×—×‘×¨ ×”××‘×•×’×¨ ×‘×™×•×ª×¨ ×‘×§×‘×•×¦×” × ×›×•×Ÿ ×œ×××™ 2025?", answers: ["×¢××™×ª ×œ×¡×¨×™", "×“×‘×™×¨ ××•×—× ×”", "×™×•×¡×£ ×§×—×œ×¨", "××¨×™××œ ×¢×™×Ÿ ×’×œ"], correct: 1 },
      { question: "××”×• ×”××™×¨×•×¢ ×”××™×ª×•×œ×•×’×™ ×©×”×ª×¨×—×© ×‘-2010 ×‘×‘×¨×™×›×”?", answers: ["×ª×§×¨×™×ª ×”×¤×™×™×¡×‘×•×§", "××™×¨×•×¢×™ ×”××¡×™×™× ×“×”", "×—×©×™×¤×ª ×™×©×‘×Ÿ ×‘×”×™×›×œ ×”×ª×¨×‘×•×ª", "×ª×§×¨×™×ª ×”×“×¨×‘×•×§×”"], correct: 1 },
      { question: "××™ ×©×¤×˜ ××ª ×ª×—×¨×•×ª ×”××¡×™×™× ×“×” ×‘-2010?", answers: ["×¢××™×ª ×œ×¡×¨×™", "×“×‘×™×¨ ×‘×¨×§×ª", "×™×•×¡×£ ×§×—×œ×¨", "×§×•×¨×Ÿ ×‘×Ÿ ××©×”"], correct: 1 },
      { question: "××” ×”×™×” ×©× ×”×©×™×¨ ×‘×¡×¨×˜×•×Ÿ ×”×ª×¢××•×œ×” × ×’×“ ×™×•×¡×£ ×§×—×œ×¨ ×‘-2010?", answers: ["×× ×™ ×™×œ×“, ×™×œ×“ ××˜×•××˜×", "××›×” ××¤×•×¨×”", "×œ×š ×ª×–×“×™×™×Ÿ, ×× ×™ ××¨×•×§××™", "×”×•× ×–×™×™×Ÿ, ×”×•× ×¡×™×™×"], correct: 0 },
      { question: "××™ ×”×’×™×‘ ×‘××©×¤×˜ '×œ×š ×ª×–×“×™×™×Ÿ, ×× ×™ ×‘×›×œ×œ ××¨×•×§××™' ×‘×ª×§×¨×™×ª ×”×“×¨×‘×•×§×”?", answers: ["×¤×œ×’ ×¡×‘×’", "×©×—×¨ ××œ××§×™×™×¡", "×¢××™×ª ×œ×¡×¨×™", "×“×‘×™×¨ ××•×—× ×”"], correct: 1 },
      { question: "××”×• ×”××™×¨×•×¢ ×©×”×¤×š ××ª ×”×—×‘×¨'×” ×”×˜×•×‘×™× ×œ×™×“×•×¢×™× ×‘-2009?", answers: ["×ª×§×¨×™×ª ×”×¤×™×™×¡×‘×•×§", "×ª×§×¨×™×ª ×‘××“×‘×¨", "×‘×¨ ×”××¦×•×•×” ×©×œ ×“×‘×™×¨ ××•×—× ×”", "×ª×—×¨×•×ª ×›×™×©×¨×•× ×•×ª"], correct: 0 },
      { question: "××™ × ×¤×¦×¢ ××¤×’×™×¢×ª ×ª×¤×•×— ×‘-2011?", answers: ["×¢××™×ª ×œ×¡×¨×™", "××¡×£ ××¨×¦×™×× ×•", "××™×›×” ×’×•×¨×œ×•×‘×¡×§×™", "× ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'"], correct: 1 },
      { question: "××” ×”×™×” ×”××™×¨×•×¢ ×”××‘×™×š ×‘×™×•×ª×¨ ×‘×ª×•×œ×“×•×ª × ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'?", answers: ["×ª×§×¨×™×ª ×‘××¦×œ××•×ª", "×¡×¨×˜×•×Ÿ ×”××•× × ×•×ª", "×–×¨×™×§×ª ××‘× ×™× ×¢×œ ×œ×™×œ×™×”", "××™×•× ×¢×œ ×¢×™×ª×•× ××™"], correct: 0 },
      { question: "×‘××™×–×• ×©× ×” ×”×—×œ×” ××¡×•×¨×ª '×‘×Ÿ ×–×•× ×” ×©×œ ×”×©× ×”'?", answers: ["2017", "2018", "2019", "2020"], correct: 2 },
      { question: "××™ ×–×›×” ×‘×ª×•××¨ '×‘×Ÿ ×–×•× ×” ×©×œ ×”×©× ×”' ×‘-2019?", answers: ["×¢××™×ª ×œ×¡×¨×™", "×™×•×¡×£ ×§×—×œ×¨", "×“×‘×™×¨ ××•×—× ×”", "×“×‘×™×¨ ×‘×¨×§×ª"], correct: 1 },
      { question: "××” ×”×™×” ×”××™×¨×•×¢ ×”××¨×›×–×™ ×‘××¡×™×‘×ª ×œ\"×’ ×‘×¢×•××¨ 2 ×‘-2014?", answers: ["×’× ×™×‘×ª ×’× ×¨×˜×•×¨", "×©×™×“×•×¨ ××©×—×§ ×©×œ ××›×‘×™ ×ª×œ ××‘×™×‘", "×ª×§×¨×™×ª ××œ×™××•×ª", "××ª×™×—×ª ×”×¦×•××”"], correct: 1 },
      { question: "××™ ×”×¦×™×œ ××ª ×—×™×™× ××¨×§×¡ ××˜×‘×™×¢×” ×‘× ×—×œ ×›×–×™×‘ ×‘-2014?", answers: ["×“×‘×™×¨ ××•×—× ×”", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜", "×¢××™×ª ×œ×¡×¨×™", "×™×•×¡×£ ×§×—×œ×¨"], correct: 1 },
      { question: "××”×• ×©× ×”××©×—×§ ×©×‘×• ××™×›×” ×’×•×¨×œ×•×‘×¡×§×™ ×”×•×¨×™×“ ××ª ××›× ×¡×™×• ×‘-2014?", answers: ["×”××— ×”×’×“×•×œ", "×¤×¨×” ×¢×™×•×•×¨×ª", "×ª×—×¨×•×ª ×›×™×©×¨×•× ×•×ª", "××ª×™×—×ª ×”×¦×•××”"], correct: 1 },
      { question: "××™ ×”×™×• ×—×‘×¨×™ '××©×•×œ×© ×”×¨×©×¢'?", answers: ["×¢××™×ª ×œ×¡×¨×™, ×“×‘×™×¨ ××•×—× ×”, ×™×•×¡×£ ×§×—×œ×¨", "×“×‘×™×¨ ×‘×¨×§×ª, ×™×•×¡×£ ×§×—×œ×¨, ××™×¦×™×§ ××•×¨ ×™×•×¡×£", "×œ×™××‘ ×‘×Ÿ ×™×¢×§×‘, ×§×•×¨×Ÿ × ××’×¨, ××¨×™××œ ×¢×™×Ÿ ×’×œ", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜, ×™×¢×§×‘ ×©×•×•×¨×¥, ××™×ª×™ ××•×—× ×”"], correct: 1 },
      { question: "××™×–×” ×—×‘×¨ ×”×¤×š ×œ××‘ ×œ×¨××©×•× ×” ×‘-2024?", answers: ["×¢××™×ª ×œ×¡×¨×™", "× ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥'", "×™×•×¡×£ ×§×—×œ×¨", "×“×‘×™×¨ ××•×—× ×”"], correct: 1 },
      { question: "×‘××™×–×• ×¢×™×¨ ×”×ª×§×™×™××” ××¡×™×‘×ª ×”×¨×•×•×§×™× ×©×œ ×™×¢×§×‘ ×©×•×•×¨×¥ ×‘-2025?", answers: ["×‘×¨×œ×™×Ÿ", "×××¡×˜×¨×“×", "×§×¤×¨×™×¡×™×Ÿ", "×‘×•×¨×’×¡"], correct: 2 },
      { question: "××™ ×™×¦×¨ ××ª ×¡×“×¨×ª ×”×¡×¨×˜×™× ×‘×œ××§×™×£?", answers: ["×¢××™×ª ×œ×¡×¨×™", "×“×‘×™×¨ ×‘×¨×§×ª", "××™×ª×™ ××•×—× ×”", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜"], correct: 1 },
      { question: "××”×• ××•×¨×›×• ×©×œ ×”×¡×¨×˜ ×”××¨×•×š ×‘×™×•×ª×¨ ×‘×¡×“×¨×ª ×‘×œ××§×™×£?", answers: ["1:28 ×“×§×•×ª", "2:39 ×“×§×•×ª", "5:15 ×“×§×•×ª", "6:45 ×“×§×•×ª"], correct: 3 },
      { question: "××™ ×©×™×—×§ ×›×—×¨×“×™ ××—×¡×™×“×•×ª ×•×™×–'× ×¥ ×‘×‘×œ××§×™×£ 5?", answers: ["×“×‘×™×¨ ××•×—× ×”", "×’'×•×¨×“×Ÿ ×‘×•×—×‘×•×˜", "××™×ª×™ ××•×—× ×”", "×¢××™×ª ×œ×¡×¨×™"], correct: 1 },
      { question: "××” ×”×™×” ×ª×¤×§×™×“×• ×©×œ ××™×¦×™×§ ××•×¨ ×™×•×¡×£ ×‘×‘×œ××§×™×£ 4?", answers: ["×—×§×œ××™", "×œ×•×—× ×—×¨×“×™", "××™×© ×‘×××œ×›×”", "×¨××¤×¨"], correct: 2 },
      { question: "××™×–×” ××™×¨×•×¢ ××©××¢×•×ª×™ ×”×ª×¨×—×© ×‘-7 ×‘××•×§×˜×•×‘×¨ 2023?", answers: ["×—×ª×•× ×ª ×¢×•××¨ ×™×•×¡×£", "××¨×™××œ ×¢×™×Ÿ ×’×œ ×”×™×” ×¢×“ ×œ×˜×‘×— ×‘×—×•×£ ×–×™×§×™×", "×¤×™×’×•×¢ ×™×¨×™ ×‘×™×¤×•", "××¡×™×‘×ª ×”×¨×•×•×§×™× ×©×œ ×™×¢×§×‘ ×©×•×•×¨×¥"], correct: 1 },
      { question: "××”×• ×”×›×™× ×•×™ ×©×œ × ×ª× ××œ ×™×•×¡×™×œ×‘×™×¥' ×‘×§×‘×•×¦×”?", answers: ["×”×•×•×˜×¨×Ÿ", "××©×•×œ×© ×”×¨×©×¢", "×›×•×›×‘ ×”×§×‘×•×¦×”", "×”××§×§×™×"], correct: 0 },
      { question: "××™×–×• ×‘×“×™×—×” ×—×•×–×¨×ª ×§×©×•×¨×” ×œ×©×—×¨ ××œ××§×™×™×¡?", answers: ["×”×•× ×–×™×™×Ÿ, ×”×•× ×¡×™×™×", "×œ×š ×ª×–×“×™×™×Ÿ, ×× ×™ ×‘×›×œ×œ ××¨×•×§××™", "×§×¢×§×•×¢×™× ×©×œ ×•×× ×¡", "×× ×™ ×™×œ×“, ×™×œ×“ ××˜×•××˜×"], correct: 1 },
    ];

    let team = [];
    let money = 1000000;
    let currentBoss = 0;
    let currentTrivia = null;

    function getStars(rating) {
      if (rating >= 94) return 'â˜…â˜…â˜…â˜…â˜…';
      if (rating >= 85) return 'â˜…â˜…â˜…â˜…';
      if (rating >= 76) return 'â˜…â˜…â˜…';
      if (rating >= 64) return 'â˜…â˜…';
      return 'â˜…';
    }

    function shootConfetti(isHighRating = false) {
      confetti({
        particleCount: isHighRating ? 200 : 100,
        spread: isHighRating ? 90 : 70,
        origin: { y: 0.6 },
        colors: isHighRating ? ['#FFD700', '#FF4500', '#00FF00'] : undefined,
      });
    }

    function init() {
      try {
        const savedTeam = localStorage.getItem("team");
        const savedMoney = localStorage.getItem("money");
        const savedBoss = localStorage.getItem("currentBoss");
        team = savedTeam ? JSON.parse(savedTeam) : [];
        money = savedMoney ? parseInt(savedMoney) : 1000000;
        currentBoss = savedBoss ? parseInt(savedBoss) : 0;
        team.forEach(player => player.stageUpgradeCount = 0);
        if (team.length === 5) {
          showMainScreen();
        } else {
          showTeamSelectionScreen();
        }
        updateUI();
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×¢×™× ×ª ×”××©×—×§: " + e.message);
      }
    }

    function showError(message) {
      document.getElementById("error").style.display = "block";
      document.getElementById("error").innerText = message;
    }

    function getRandomTeam() {
      const shuffled = [...players].sort(() => Math.random() - 0.5);
      return shuffled.slice(0, 5).map(player => ({
        ...player,
        health: 100,
        upgradeCount: 0,
        stageUpgradeCount: 0
      }));
    }

    function calculateAverageRating() {
      if (team.length === 0) return 0;
      return team.reduce((sum, player) => sum + player.rating, 0) / team.length;
    }

    function startGame() {
      document.getElementById("welcome-screen").classList.add("hidden");
      document.getElementById("team-selection-screen").classList.remove("hidden");
    }

    function showTeamSelectionScreen() {
      document.getElementById("main-screen").classList.add("hidden");
      document.getElementById("team-selection-screen").classList.remove("hidden");
      document.getElementById("trivia-screen").classList.add("hidden");
      document.getElementById("transfers-screen").classList.add("hidden");
      document.getElementById("team-popup").classList.add("hidden");
      document.getElementById("battle-popup").classList.add("hidden");
    }

    function showMainScreen() {
      document.getElementById("main-screen").classList.remove("hidden");
      document.getElementById("team-selection-screen").classList.add("hidden");
      document.getElementById("trivia-screen").classList.add("hidden");
      document.getElementById("transfers-screen").classList.add("hidden");
      document.getElementById("team-popup").classList.add("hidden");
      document.getElementById("battle-popup").classList.add("hidden");
      updateUI();
    }

    function selectRandomTeam() {
      team = getRandomTeam();
      localStorage.setItem("team", JSON.stringify(team));
      const teamRevealDiv = document.getElementById("team-reveal");
      teamRevealDiv.innerHTML = "";
      team.forEach((player, index) => {
        setTimeout(() => {
          const card = document.createElement("div");
          card.className = `player-card p-6 rounded-xl shadow-lg player-reveal ${player.rating >= 90 ? 'dance' : ''}`;
          card.innerHTML = `<div class="text-center"><span class="text-4xl">ğŸ‡®ğŸ‡±</span></div>`;
          teamRevealDiv.appendChild(card);
          setTimeout(() => {
            card.innerHTML = `
              <div class="text-center">
                <span class="text-4xl">ğŸ‡®ğŸ‡±</span>
                <p class="text-2xl font-bold mt-4">${player.rating}</p>
                <p class="star text-2xl">${getStars(player.rating)}</p>
              </div>
            `;
            if (player.rating >= 90) shootConfetti(true);
          }, 1000);
          setTimeout(() => {
            card.innerHTML = `
              <div class="text-center">
                <span class="text-4xl">ğŸ‡®ğŸ‡±</span>
                <h2 class="text-xl font-bold mt-4">${player.name}</h2>
                <p>×ª×¤×§×™×“: ${player.role}</p>
                <p>×“×™×¨×•×’: ${player.rating}</p>
                <p class="star">${getStars(player.rating)}</p>
                <p>×©×•×•×™: ${player.value.toLocaleString()} â‚ª</p>
                <p>×‘×¨×™××•×ª: ${player.health.toFixed(1)}%</p>
              </div>
            `;
            if (index === team.length - 1) {
              setTimeout(() => {
                document.getElementById("team-selection-screen").classList.add("hidden");
                document.getElementById("team-popup").classList.remove("hidden");
              }, 1000);
            }
          }, 2000);
        }, index * 3000);
      });
    }

    function updateUI() {
      try {
        document.getElementById("money").innerText = `×›×¡×£ ×–××™×Ÿ: ${money.toLocaleString()} â‚ª`;
        document.getElementById("current-boss").innerText = `×‘×•×¡ × ×•×›×—×™: ${bosses[currentBoss].name} (×“×™×¨×•×’ × ×“×¨×©: ${bosses[currentBoss].requiredRating})`;
        document.getElementById("avg-rating").innerText = `×“×™×¨×•×’ ×××•×¦×¢: ${calculateAverageRating().toFixed(1)}`;
        document.getElementById("battle-btn").disabled = team.length !== 5 || team.some(player => player.health <= 0);

        const teamDiv = document.getElementById("team");
        teamDiv.innerHTML = "";
        team.forEach((player, index) => {
          const card = document.createElement("div");
          card.className = "card bg-gray-900 p-4 rounded-xl shadow-lg";
          card.innerHTML = `
            <div class="text-center">
              <span class="text-2xl">ğŸ‡®ğŸ‡±</span>
              <h2 class="text-xl font-bold mt-2">${player.name}</h2>
              <p>×ª×¤×§×™×“: ${player.role}</p>
              <p>×“×™×¨×•×’: ${player.rating}</p>
              <p class="star">${getStars(player.rating)}</p>
              <p>×©×•×•×™: ${player.value.toLocaleString()} â‚ª</p>
              <p>×‘×¨×™××•×ª: ${player.health.toFixed(1)}%</p>
              <div class="relative inline-block text-left mt-2">
                <select onchange="handlePlayerAction(${index}, this.value)" class="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 transition">
                  <option value="" disabled selected>×©×™×¤×•×¨/×¨×™×¤×•×™ ×©×—×§×Ÿ</option>
                  <option value="upgrade" ${player.upgradeCount >= 5 || player.stageUpgradeCount >= 2 ? 'disabled' : ''}>×ª×‘×™× ×œ×• ×‘×™×“</option>
                  <option value="heal" ${money < 10000 || player.health >= 100 ? 'disabled' : ''}>×¨×™×¤×•×™ ×œ××—×¨ ×§×¨×‘ (10,000 â‚ª)</option>
                </select>
              </div>
              <button onclick="sellPlayer(${index})" class="mt-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition">××›×•×¨</button>
            </div>
          `;
          teamDiv.appendChild(card);
        });
      } catch (e) {
        showError("×©×’×™××” ×‘×¢×“×›×•×Ÿ ×××©×§: " + e.message);
      }
    }

    function handlePlayerAction(index, action) {
      try {
        const player = team[index];
        if (action === "upgrade") {
          if (player.upgradeCount >= 5) {
            alert("×”×’×¢×ª ×œ××’×‘×œ×” ×©×œ 5 ×©×™×¤×•×¨×™× ×¢×‘×•×¨ ×©×—×§×Ÿ ×–×”!");
            return;
          }
          if (player.stageUpgradeCount >= 2) {
            alert("×”×’×¢×ª ×œ××’×‘×œ×” ×©×œ 2 ×©×™×¤×•×¨×™× ×œ×©×œ×‘ ×–×”!");
            return;
          }
          if (player.name === "×“×‘×™×¨ ×‘×¨×§×ª") {
            player.rating += 5;
          } else if (player.name === "××¨×™××œ ×©×¨×‘×™×˜") {
            player.rating -= 15;
          } else {
            player.rating += 1;
          }
          player.rating = Math.max(0, Math.min(99, player.rating));
          player.upgradeCount += 1;
          player.stageUpgradeCount += 1;
          localStorage.setItem("team", JSON.stringify(team));
          alert(`×©×“×¨×’×ª ××ª ${player.name}! ×”×“×™×¨×•×’ ×”×—×“×©: ${player.rating}`);
          if (player.rating >= 90) shootConfetti(true);
        } else if (action === "heal") {
          if (money < 10000) {
            alert("××™×Ÿ ××¡×¤×™×§ ×›×¡×£ ×œ×¨×™×¤×•×™!");
            return;
          }
          if (player.health >= 100) {
            alert("×”×©×—×§×Ÿ ×›×‘×¨ ×‘×¨×™× ×œ×’××¨×™!");
            return;
          }
          player.health = Math.min(100, player.health + 10);
          money -= 10000;
          localStorage.setItem("money", money);
          localStorage.setItem("team", JSON.stringify(team));
          alert(`×¨×™×¤××ª ××ª ${player.name}! ×‘×¨×™××•×ª ×—×“×©×”: ${player.health.toFixed(1)}%`);
        }
        updateUI();
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×™×¤×•×œ ×‘×¤×¢×•×œ×ª ×©×—×§×Ÿ: " + e.message);
      }
    }

    function showBattlePopup() {
      try {
        if (team.length !== 5) {
          alert("×—×™×™×‘×™× 5 ×©×—×§× ×™× ×›×“×™ ×œ×”×™×œ×—×!");
          return;
        }
        if (team.some(player => player.health <= 0)) {
          alert("××—×“ ××• ×™×•×ª×¨ ××”×©×—×§× ×™× ×¤×¦×•×¢×™× ×§×©×”! ×¨×¤× ××•×ª× ××• ×”×—×œ×£ ××•×ª×.");
          return;
        }
        document.getElementById("main-screen").classList.add("hidden");
        document.getElementById("battle-popup").classList.remove("hidden");
        document.getElementById("battle-title").innerText = `×”×‘×•×¡: ${bosses[currentBoss].name}`;
        document.getElementById("battle-description").innerText = bosses[currentBoss].description;
      } catch (e) {
        showError("×©×’×™××” ×‘×”×¦×’×ª ×¤×•×¤-××¤ ×§×¨×‘: " + e.message);
      }
    }

    function proceedToBattle() {
      try {
        document.getElementById("battle-popup").classList.add("hidden");
        startBattle();
      } catch (e) {
        showError("×©×’×™××” ×‘×”×ª×—×œ×ª ×”×§×¨×‘: " + e.message);
      }
    }

    function startBattle() {
      try {
        if (team.length !== 5) {
          alert("×—×™×™×‘×™× 5 ×©×—×§× ×™× ×›×“×™ ×œ×”×™×œ×—×!");
          return;
        }
        const avgRating = calculateAverageRating();
        const required = bosses[currentBoss].requiredRating;

        // ×—×™×©×•×‘ ××•×‘×“×Ÿ ×‘×¨×™××•×ª ×œ×¤×™ ×”×¤×¨×© ×“×™×¨×•×’
        team.forEach(player => {
          const ratingDiff = required - player.rating;
          const healthLoss = Math.max(5, ratingDiff * 2);
          player.health = Math.max(0, player.health - healthLoss);
        });

        if (avgRating >= required) {
          money += 1000000;
          let narrative = `× ×™×¦×—×ª× ××ª ${bosses[currentBoss].name}! ×”×—×‘×¨'×” ×”×˜×•×‘×™× ×”×¨××• ××™ ×‘×¢×œ ×”×‘×™×ª! ×”×¨×•×•×—×ª× 1,000,000 â‚ª!`;
          if (currentBoss === bosses.length - 1) {
            narrative += "\n×”×©×œ××ª× ××ª ×”××¡×¢! ×”×—×‘×¨'×” ×”×˜×•×‘×™× ×©×œ×˜×• ×‘×›×œ ×”×‘×•×¡×™×!";
          } else {
            narrative += `\n×”×ª×›×•× × ×• ×œ××ª×’×¨ ×”×‘× × ×’×“ ${bosses[currentBoss + 1].name}!`;
          }
          alert(narrative);
          currentBoss = Math.min(currentBoss + 1, bosses.length - 1);
          team.forEach(player => player.stageUpgradeCount = 0);
          shootConfetti(true);
        } else {
          let narrative = `×”×¤×¡×“×ª× ×œ-${bosses[currentBoss].name}! ×”×“×™×¨×•×’ ×”×××•×¦×¢ ×©×œ×›× (${avgRating.toFixed(1)}) ×œ× ×”×¡×¤×™×§ × ×’×“ ×”×“×¨×™×©×” (${required}).\n`;
          narrative += "×”×©×—×§× ×™× ×©×œ×›× × ×¤×¦×¢×•! ×¨×¤××• ××•×ª× ×‘-10,000 â‚ª ××• ×”×—×œ×™×¤×• ××•×ª× ×‘×—×œ×•×Ÿ ×”×”×¢×‘×¨×•×ª ×›×“×™ ×œ×”××©×™×š.";
          alert(narrative);
          // Do not reset team, keep the injured players
        }
        localStorage.setItem("team", JSON.stringify(team));
        localStorage.setItem("money", money);
        localStorage.setItem("currentBoss", currentBoss);
        showMainScreen();
      } catch (e) {
        showError("×©×’×™××” ×‘×§×¨×‘: " + e.message);
      }
    }

    function startTrivia() {
      try {
        currentTrivia = triviaQuestions[Math.floor(Math.random() * triviaQuestions.length)];
        document.getElementById("main-screen").classList.add("hidden");
        document.getElementById("trivia-screen").classList.remove("hidden");
        document.getElementById("trivia-question").innerText = currentTrivia.question;
        const answersDiv = document.getElementById("trivia-answers");
        answersDiv.innerHTML = "";
        currentTrivia.answers.forEach((answer, index) => {
          const button = document.createElement("button");
          button.className = "p-4 rounded-lg bg-gray-700 hover:bg-gray-600 transition";
          button.innerText = answer;
          button.onclick = () => handleTriviaAnswer(index);
          answersDiv.appendChild(button);
        });
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×¢×™× ×ª ×˜×¨×™×•×•×™×”: " + e.message);
      }
    }

    function handleTriviaAnswer(index) {
      try {
        if (index === currentTrivia.correct) {
          money += 50000;
          alert("×ª×©×•×‘×” × ×›×•× ×”! ×”×¨×•×•×—×ª 50,000 â‚ª!");
          shootConfetti();
        } else {
          alert("×ª×©×•×‘×” ×œ× × ×›×•× ×”, × ×¡×” ×©×•×‘!");
        }
        nextTrivia();
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×™×¤×•×œ ×‘×ª×©×•×‘×ª ×˜×¨×™×•×•×™×”: " + e.message);
      }
    }

    function nextTrivia() {
      try {
        currentTrivia = triviaQuestions[Math.floor(Math.random() * triviaQuestions.length)];
        document.getElementById("trivia-question").innerText = currentTrivia.question;
        const answersDiv = document.getElementById("trivia-answers");
        answersDiv.innerHTML = "";
        currentTrivia.answers.forEach((answer, index) => {
          const button = document.createElement("button");
          button.className = "p-4 rounded-lg bg-gray-700 hover:bg-gray-600 transition";
          button.innerText = answer;
          button.onclick = () => handleTriviaAnswer(index);
          answersDiv.appendChild(button);
        });
      } catch (e) {
        showError("×©×’×™××” ×‘×˜×¢×™× ×ª ×©××œ×ª ×˜×¨×™×•×•×™×” ×—×“×©×”: " + e.message);
      }
    }

    function backToMain() {
      document.getElementById("main-screen").classList.remove("hidden");
      document.getElementById("trivia-screen").classList.add("hidden");
      document.getElementById("transfers-screen").classList.add("hidden");
      document.getElementById("battle-popup").classList.add("hidden");
      updateUI();
    }

    function showTransfers() {
      try {
        document.getElementById("main-screen").classList.add("hidden");
        document.getElementById("transfers-screen").classList.remove("hidden");
        const transfersDiv = document.getElementById("transfers");
        transfersDiv.innerHTML = "";
        players.forEach((player, index) => {
          if (!team.some(p => p.name === player.name)) {
            const card = document.createElement("div");
            card.className = "card bg-gray-900 p-4 rounded-xl shadow-lg";
            card.innerHTML = `
              <div class="text-center">
                <span class="text-2xl">ğŸ‡®ğŸ‡±</span>
                <h2 class="text-xl font-bold mt-2">${player.name}</h2>
                <p>×ª×¤×§×™×“: ${player.role}</p>
                <p>×“×™×¨×•×’: ${player.rating}</p>
                <p class="star">${getStars(player.rating)}</p>
                <p>×©×•×•×™: ${player.value.toLocaleString()} â‚ª</p>
                <button onclick="buyPlayer(${index})" class="mt-2 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition" ${money < player.value ? 'disabled' : ''}>×§× ×”</button>
              </div>
            `;
            transfersDiv.appendChild(card);
          }
        });
      } catch (e) {
        showError("×©×’×™××” ×‘×”×¦×’×ª ×—×œ×•×Ÿ ×”×¢×‘×¨×•×ª: " + e.message);
      }
    }

    function sellPlayer(index) {
      try {
        const player = team[index];
        money += player.value;
        team.splice(index, 1);
        localStorage.setItem("team", JSON.stringify(team));
        localStorage.setItem("money", money);
        alert(`××›×¨×ª ××ª ${player.name} ×ª××•×¨×ª ${player.value.toLocaleString()} â‚ª!`);
        updateUI();
      } catch (e) {
        showError("×©×’×™××” ×‘××›×™×¨×ª ×©×—×§×Ÿ: " + e.message);
      }
    }

    function buyPlayer(index) {
      try {
        const player = { ...players[index], health: 100, upgradeCount: 0, stageUpgradeCount: 0 };
        if (money < player.value) {
          alert("××™×Ÿ ××¡×¤×™×§ ×›×¡×£ ×œ×§× ×™×™×ª ×”×©×—×§×Ÿ!");
          return;
        }
        if (team.length >= 5) {
          alert("×”×§×‘×•×¦×” ××œ××”! ××›×•×¨ ×©×—×§×Ÿ ×§×•×“×.");
          return;
        }
        money -= player.value;
        team.push(player);
        localStorage.setItem("team", JSON.stringify(team));
        localStorage.setItem("money", money);
        alert(`×§× ×™×ª ××ª ${player.name} ×ª××•×¨×ª ${player.value.toLocaleString()} â‚ª!`);
        shootConfetti(player.rating >= 90);
        backToMain();
      } catch (e) {
        showError("×©×’×™××” ×‘×§× ×™×™×ª ×©×—×§×Ÿ: " + e.message);
      }
    }

    init();
  </script>
</body>
</html>
