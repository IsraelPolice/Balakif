<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>The Hevre Hatovim Inc.</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.3.1/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.25.6/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com/3.4.10"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Impact&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { 
      font-family: 'Inter', sans-serif; 
      background-color: #F0F2F5; 
      margin: 0;
    }
    #loading { 
      display: flex; 
      justify-content: center; 
      align-items: center; 
      height: 100vh; 
      color: #1877F2; 
    }
    #error { 
      text-align: center; 
      padding: 2rem; 
      color: #DC2626; 
    }
    .custom-button { 
      background-color: #1877F2; 
      color: white; 
      padding: 0.5rem 1.5rem; 
      border-radius: 6px; 
      font-weight: 600; 
      transition: background-color 0.2s ease; 
    }
    .custom-button:hover { 
      background-color: #1659C7; 
    }
    .card { 
      background: white; 
      border-radius: 8px; 
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); 
      padding: 1rem; 
      transition: box-shadow 0.2s ease; 
      height: 16rem; 
      display: flex; 
      flex-direction: column; 
      justify-content: space-between; 
    }
    .card:hover { 
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); 
    }
    .card-title { 
      font-size: 1.25rem; 
      font-weight: 600; 
      color: #1C2526; 
      margin-bottom: 0.5rem; 
      height: 4rem; 
      overflow: hidden; 
      display: -webkit-box; 
      -webkit-line-clamp: 2; 
      -webkit-box-orient: vertical; 
      text-align: center;
    }
    .game-card {
      background: linear-gradient(135deg, #1877F2 0%, #34D399 100%);
      color: white;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      height: 20rem;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
    }
    .game-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 24px rgba(0, 0, 0, 0.25);
    }
    .game-card-title {
      font-family: 'Impact', sans-serif;
      font-size: 1.75rem;
      font-weight: 700;
      color: white;
      text-transform: uppercase;
      text-align: center;
      margin-bottom: 0.75rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }
    .game-image {
      width: 100px;
      height: 100px;
      object-fit: contain;
      margin-bottom: 0.75rem;
    }
    #auth-popup { 
      display: flex; 
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      background: rgba(0, 0, 0, 0.5); 
      z-index: 50; 
      justify-content: center; 
      align-items: center; 
    }
    #auth-popup.hidden { 
      display: none; 
    }
    .leadership-section { 
      background-color: white; 
      padding: 2rem 1rem; 
      border-top: 1px solid #E4E6EB; 
    }
    .leadership-title { 
      font-size: 1.5rem; 
      font-weight: 700; 
      color: #1C2526; 
      margin-bottom: 1.5rem; 
      text-align: center; 
    }
    .leadership-card { 
      background: white; 
      border-radius: 8px; 
      padding: 1rem; 
      text-align: center; 
    }
    .leader-image { 
      border-radius: 50%; 
      object-fit: cover; 
      border: 2px solid #E4E6EB; 
    }
    .logo { 
      font-family: 'Impact', sans-serif; 
      color: #000000; 
      font-weight: 700; 
      font-size: 1.75rem; 
      line-height: 1; 
      text-transform: uppercase; 
      position: relative; 
      letter-spacing: -0.05em;
      white-space: nowrap;
    }
    .logo::after { 
      content: ''; 
      position: absolute; 
      bottom: -4px; 
      right: 0; 
      width: 50%; 
      height: 4px; 
      background-color: #E50914; 
    }
    nav {
      position: relative;
      top: 0;
      width: 100%;
      z-index: 40;
    }
    @media (max-width: 639px) {
      nav {
        position: fixed;
      }
      .content-container {
        padding-top: 4rem;
      }
      .logo { 
        font-size: 1.25rem; 
        line-height: 1.2;
      }
      .logo::after { 
        height: 3px; 
        width: 60%; 
      }
      .game-card {
        height: 18rem;
      }
      .game-card-title {
        font-size: 1.5rem;
      }
      .game-image {
        width: 80px;
        height: 80px;
      }
    }
    @media (min-width: 640px) {
      .leadership-section { padding: 3rem 1.5rem; }
      .leadership-title { font-size: 1.75rem; }
      .leadership-card { padding: 1.5rem; }
    }
    .forum-section {
      background-color: white;
      padding: 2rem 1rem;
      border-top: 1px solid #E4E6EB;
    }
    .forum-post {
      background: white;
      border: 1px solid #E4E6EB;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      transition: box-shadow 0.2s ease;
    }
    .forum-post:hover {
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .forum-textarea {
      width: 100%;
      padding: 1rem;
      border: 1px solid #E4E6EB;
      border-radius: 8px;
      resize: vertical;
      min-height: 100px;
      font-family: 'Inter', sans-serif;
      font-size: 0.875rem;
    }
    .forum-textarea:focus {
      outline: none;
      border-color: #1877F2;
      box-shadow: 0 0 0 2px rgba(24, 119, 242, 0.1);
    }
    .like-button {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: #F0F2F5;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.875rem;
    }
    .like-button:hover {
      background: #E4E6EB;
    }
    .like-button.liked {
      background: #1877F2;
      color: white;
    }
    .forum-post-content {
      white-space: pre-wrap;
      word-wrap: break-word;
      line-height: 1.5;
      color: #1C2526;
      font-size: 0.875rem;
    }
    .forum-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.75rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid #E4E6EB;
    }
    .forum-meta {
      color: #65676B;
      font-size: 0.75rem;
    }
    .topic-filter {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
      justify-content: center;
    }
    .topic-button {
      padding: 0.5rem 1rem;
      border: 1px solid #E4E6EB;
      background: white;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.875rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    .topic-button:hover {
      background: #F0F2F5;
    }
    .topic-button.active {
      background: #1877F2;
      color: white;
      border-color: #1877F2;
    }
    .reply-section {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid #E4E6EB;
    }
    .reply-item {
      background: #F0F2F5;
      border-radius: 8px;
      padding: 0.75rem;
      margin-top: 0.5rem;
      margin-right: 2rem;
    }
    .reply-form {
      margin-top: 0.75rem;
      display: none;
    }
    .reply-form.active {
      display: block;
    }
    .reply-textarea {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #E4E6EB;
      border-radius: 8px;
      resize: vertical;
      min-height: 60px;
      font-family: 'Inter', sans-serif;
      font-size: 0.875rem;
    }
    .reply-textarea:focus {
      outline: none;
      border-color: #1877F2;
      box-shadow: 0 0 0 2px rgba(24, 119, 242, 0.1);
    }
    .passcode-popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .passcode-content {
      background: white;
      border-radius: 12px;
      padding: 2rem;
      max-width: 400px;
      width: 90%;
    }
    .author-badge {
      display: inline-flex;
      align-items: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div id="root">
    <div id="loading" className="text-2xl">טוען...</div>
  </div>
  <script type="text/babel" data-presets="env,react">
    console.log('Babel script loaded, attempting to render React app...');

    const supabase = window.supabase.createClient(
      'https://qhgdwgosximyouysmupq.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFoZ2R3Z29zeGlteW91eXNtdXBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1OTU0ODgsImV4cCI6MjA3NjE3MTQ4OH0.o94wxtUyvqF44FWazC10nM39uMAeHiLpXveoSmX4NbM'
    );

    const AuthPopup = () => {
      const [question, setQuestion] = React.useState(null);
      const [answer, setAnswer] = React.useState('');
      const [error, setError] = React.useState(false);

      const questions = [
        { question: 'כיצד נקראה הכלבה של יוסף קחלר?', answers: ['תותי'] },
        { question: 'מי המנהל השותף הנוסף חוץ מעמית לסרי?', answers: ['יוסף', 'קחלר', 'יוסף קחלר'] },
        { question: 'מי האבא הראשון בחברה?', answers: ['נתי', 'נתנאל'] },
        { question: 'מי מפקח הבחירות השנתי של החברה הטובים?', answers: ['חיים', 'מרקס', 'חיים מרקס'] },
      ];

      React.useEffect(() => {
        console.log('Selecting random question...');
        const randomIndex = Math.floor(Math.random() * questions.length);
        setQuestion(questions[randomIndex]);
      }, []);

      const handleSubmit = () => {
        console.log('handleSubmit triggered, answer:', answer);
        if (!question || !answer.trim()) {
          console.log('No question or empty answer');
          setError(true);
          return;
        }

        const isCorrect = question.answers.some(ans => {
          const normalizedAnswer = answer.trim().toLowerCase();
          const normalizedCorrect = ans.toLowerCase();
          console.log(`Comparing: user answer "${normalizedAnswer}" vs correct answer "${normalizedCorrect}"`);
          return normalizedAnswer === normalizedCorrect;
        });

        if (isCorrect) {
          console.log('Correct answer, hiding popup');
          const popup = document.getElementById('auth-popup');
          if (popup) {
            popup.classList.add('hidden');
          } else {
            console.error('Popup element not found');
          }
          setError(false);
        } else {
          console.log('Incorrect answer');
          setError(true);
        }
      };

      const handleKeyPress = (e) => {
        if (e.key === 'Enter') {
          console.log('Enter key pressed, triggering handleSubmit');
          handleSubmit();
        }
      };

      return (
        <div id="auth-popup" className="flex justify-center items-center">
          <div className="bg-white rounded-lg shadow-xl p-6 max-w-md w-full text-center">
            <i className="fas fa-lock text-blue-600 text-3xl mb-4"></i>
            <h2 className="text-2xl font-bold text-gray-800 mb-4">גישה מוגבלת</h2>
            <p className="text-base text-gray-600 mb-6">על מנת להיכנס לאתר, עליך להיות בין 21 החברים הרשומים כיום בחבר׳ה הטובים.</p>
            <p className="text-base text-gray-800 font-semibold mb-4">{question ? question.question : 'טוען שאלה...'}</p>
            <input
              type="text"
              value={answer}
              onChange={(e) => setAnswer(e.target.value)}
              onKeyPress={handleKeyPress}
              className="w-full p-2 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-600 text-base"
              placeholder="הזן תשובה"
            />
            <p className={`text-red-500 text-sm mb-4 ${error ? '' : 'hidden'}`}>תשובה שגויה. נסה שוב.</p>
            <button
              onClick={handleSubmit}
              className="custom-button px-6 py-2 font-bold w-full text-base"
            >
              אשר
            </button>
          </div>
        </div>
      );
    };

    const Nav = () => (
      <nav className="bg-white shadow-sm border-b border-gray-200">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <div className="flex items-center">
              <span className="logo">The Hevre Hatovim Inc.</span>
            </div>
            <div className="flex items-center space-x-4">
              <a href="#home" className="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition">בית</a>
              <a href="#about" className="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition">אודות</a>
              <a href="#contact" className="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition">צור קשר</a>
            </div>
          </div>
        </div>
      </nav>
    );

    const Leadership = () => (
      <section className="leadership-section content-container">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <h2 className="leadership-title">הנהגת החבר׳ה הטובים</h2>
          <div className="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8">
            <div className="leadership-card">
              <img
                src="https://i.ibb.co/YYgWt7f/Screenshot-2025-05-23-at-10-12-15.png"
                alt="עמית לסרי"
                className="w-24 h-24 mx-auto mb-3 leader-image"
                onError={(e) => { console.log('Failed to load Amit Lasri image'); e.target.src = 'https://via.placeholder.com/128'; }}
              />
              <h3 className="text-lg font-bold text-gray-800">מנהיג הקבוצה: עמית לסרי</h3>
            </div>
            <div className="leadership-card">
              <img
                src="https://i.postimg.cc/c19xJLX7/Screenshot-2025-05-23-at-13-19-37.png"
                alt="יוסף קחלר"
                className="w-24 h-24 mx-auto mb-3 leader-image"
                onError={(e) => { console.log('Failed to load Yosef Kahler image'); e.target.src = 'https://via.placeholder.com/128'; }}
              />
              <h3 className="text-lg font-bold text-gray-800">מנהל שותף: יוסף קחלר</h3>
            </div>
            <div className="leadership-card">
              <img
                src="https://i.postimg.cc/xdxCsgbt/Screenshot-2025-05-23-at-10-48-37.png"
                alt="דביר אוחנה"
                className="w-24 h-24 mx-auto mb-3 leader-image"
                onError={(e) => { console.log('Failed to load Dvir Ohana image'); e.target.src = 'https://via.placeholder.com/128'; }}
              />
              <h3 className="text-lg font-bold text-gray-800">כוכב: דביר אוחנה</h3>
            </div>
          </div>
          <div className="text-center mt-8 mb-4">
            <div className="inline-flex items-center gap-4 bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-3">
              <a href="https://israelpolice.github.io/Balakif/pages/good-guys.html" className="text-blue-600 hover:text-blue-700 font-semibold transition text-base">
                <i className="fas fa-book ml-2"></i>
                ויקיחבר׳ה
              </a>
              <span className="text-gray-300">|</span>
              <a href="#forum" className="text-blue-600 hover:text-blue-700 font-semibold transition text-base">
                <i className="fas fa-comments ml-2"></i>
                פורום אנונימי
              </a>
            </div>
          </div>
        </div>
      </section>
    );

    const Forum = () => {
      const [posts, setPosts] = React.useState([]);
      const [newPost, setNewPost] = React.useState('');
      const [loading, setLoading] = React.useState(true);
      const [posting, setPosting] = React.useState(false);
      const [likedPosts, setLikedPosts] = React.useState(new Set());
      const [selectedTopic, setSelectedTopic] = React.useState('הכל');
      const [topics, setTopics] = React.useState([]);
      const [replyingTo, setReplyingTo] = React.useState(null);
      const [replyContent, setReplyContent] = React.useState('');
      const [showPasscodePopup, setShowPasscodePopup] = React.useState(false);
      const [passcode, setPasscode] = React.useState('');
      const [selectedAuthor, setSelectedAuthor] = React.useState('');
      const [postTopic, setPostTopic] = React.useState('כללי');

      const AUTHORS = [
        'Liav Ben Yaakov',
        'Dvir Ohana',
        'Yosef Kachler',
        'Amit Lasri',
        'Jordan Bohbot',
        'Chaim Marks',
        'Ariel Ein Gal',
        'Yogev Shabtay',
        'Ariel Sharvit'
      ];

      const CORRECT_PASSCODE = '316439249';

      React.useEffect(() => {
        loadPosts();
        loadTopics();
        const savedLikes = localStorage.getItem('likedPosts');
        if (savedLikes) {
          setLikedPosts(new Set(JSON.parse(savedLikes)));
        }
      }, []);

      const loadTopics = async () => {
        try {
          const { data, error } = await supabase
            .from('forum_topics')
            .select('*')
            .order('created_at', { ascending: true });

          if (error) throw error;
          setTopics(data || []);
        } catch (error) {
          console.error('Error loading topics:', error);
        }
      };

      const loadPosts = async () => {
        try {
          const { data, error } = await supabase
            .from('forum_posts')
            .select('*')
            .is('parent_id', null)
            .order('created_at', { ascending: false });

          if (error) throw error;

          for (let post of (data || [])) {
            const { data: replies } = await supabase
              .from('forum_posts')
              .select('*')
              .eq('parent_id', post.id)
              .order('created_at', { ascending: true });
            post.replies = replies || [];
          }

          setPosts(data || []);
        } catch (error) {
          console.error('Error loading posts:', error);
        } finally {
          setLoading(false);
        }
      };

      const handleSubmitPost = async () => {
        if (!newPost.trim() || posting) return;

        setPosting(true);
        try {
          const postData = {
            content: newPost.trim(),
            topic: postTopic,
            author_name: selectedAuthor || null
          };

          const { error } = await supabase
            .from('forum_posts')
            .insert([postData]);

          if (error) throw error;

          setNewPost('');
          setSelectedAuthor('');
          setPostTopic('כללי');
          await loadPosts();
        } catch (error) {
          console.error('Error posting:', error);
          alert('שגיאה בפרסום ההודעה. נסה שוב.');
        } finally {
          setPosting(false);
        }
      };

      const handleSubmitReply = async (parentId) => {
        if (!replyContent.trim() || posting) return;

        setPosting(true);
        try {
          const replyData = {
            content: replyContent.trim(),
            parent_id: parentId,
            author_name: selectedAuthor || null
          };

          const { error } = await supabase
            .from('forum_posts')
            .insert([replyData]);

          if (error) throw error;

          setReplyContent('');
          setReplyingTo(null);
          setSelectedAuthor('');
          await loadPosts();
        } catch (error) {
          console.error('Error posting reply:', error);
          alert('שגיאה בפרסום התגובה. נסה שוב.');
        } finally {
          setPosting(false);
        }
      };

      const handlePasscodeSubmit = () => {
        if (passcode === CORRECT_PASSCODE) {
          setShowPasscodePopup(false);
          setPasscode('');
        } else {
          alert('קוד שגוי. נסה שוב.');
          setPasscode('');
        }
      };

      const handleLike = async (postId, currentLikes) => {
        const isLiked = likedPosts.has(postId);
        const newLikes = isLiked ? currentLikes - 1 : currentLikes + 1;

        try {
          const { error } = await supabase
            .from('forum_posts')
            .update({ likes: newLikes })
            .eq('id', postId);

          if (error) throw error;

          const updatedLikedPosts = new Set(likedPosts);
          if (isLiked) {
            updatedLikedPosts.delete(postId);
          } else {
            updatedLikedPosts.add(postId);
          }
          setLikedPosts(updatedLikedPosts);
          localStorage.setItem('likedPosts', JSON.stringify([...updatedLikedPosts]));

          await loadPosts();
        } catch (error) {
          console.error('Error updating likes:', error);
        }
      };

      const formatDate = (dateString) => {
        const date = new Date(dateString);
        const now = new Date();
        const diffMs = now - date;
        const diffMins = Math.floor(diffMs / 60000);
        const diffHours = Math.floor(diffMs / 3600000);
        const diffDays = Math.floor(diffMs / 86400000);

        if (diffMins < 1) return 'עכשיו';
        if (diffMins < 60) return `לפני ${diffMins} דקות`;
        if (diffHours < 24) return `לפני ${diffHours} שעות`;
        if (diffDays < 7) return `לפני ${diffDays} ימים`;
        return date.toLocaleDateString('he-IL');
      };

      const filteredPosts = selectedTopic === 'הכל'
        ? posts
        : posts.filter(post => post.topic === selectedTopic);

      return (
        <section id="forum" className="forum-section content-container">
          <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 className="leadership-title">
              <i className="fas fa-comments ml-2"></i>
              פורום החבר'ה הטובים
            </h2>
            <p className="text-center text-gray-600 mb-6 text-base">שתף מחשבות, רעיונות והודעות. פרסום אנונימי או עם שם (בקוד)</p>

            <div className="topic-filter">
              <button
                className={`topic-button ${selectedTopic === 'הכל' ? 'active' : ''}`}
                onClick={() => setSelectedTopic('הכל')}
              >
                <i className="fas fa-globe"></i>
                הכל
              </button>
              {topics.map(topic => (
                <button
                  key={topic.id}
                  className={`topic-button ${selectedTopic === topic.name ? 'active' : ''}`}
                  onClick={() => setSelectedTopic(topic.name)}
                >
                  <i className={`fas ${topic.icon}`}></i>
                  {topic.name}
                </button>
              ))}
            </div>

            <div className="mb-8 bg-white p-4 rounded-lg shadow-sm border border-gray-200">
              <div className="mb-3">
                <label className="text-sm font-semibold text-gray-700 mb-2 block">נושא:</label>
                <select
                  className="w-full p-2 border border-gray-300 rounded-lg text-sm"
                  value={postTopic}
                  onChange={(e) => setPostTopic(e.target.value)}
                >
                  {topics.map(topic => (
                    <option key={topic.id} value={topic.name}>{topic.name}</option>
                  ))}
                </select>
              </div>
              <textarea
                className="forum-textarea"
                placeholder="כתוב הודעה..."
                value={newPost}
                onChange={(e) => setNewPost(e.target.value)}
                maxLength={1000}
              />
              <div className="flex justify-between items-center mt-3 flex-wrap gap-2">
                <div className="flex items-center gap-2">
                  <span className="text-xs text-gray-500">{newPost.length}/1000 תווים</span>
                  {selectedAuthor && (
                    <span className="author-badge">
                      <i className="fas fa-user ml-1"></i>
                      {selectedAuthor}
                    </span>
                  )}
                </div>
                <div className="flex gap-2">
                  <button
                    onClick={() => setShowPasscodePopup(true)}
                    className="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition text-sm font-semibold"
                  >
                    <i className="fas fa-key ml-1"></i>
                    פרסם עם שם
                  </button>
                  <button
                    onClick={handleSubmitPost}
                    disabled={!newPost.trim() || posting}
                    className="custom-button px-6 py-2 font-bold text-sm disabled:opacity-50 disabled:cursor-not-allowed"
                  >
                    {posting ? 'מפרסם...' : 'פרסם'}
                  </button>
                </div>
              </div>
            </div>

            {loading ? (
              <div className="text-center py-8 text-gray-600">טוען הודעות...</div>
            ) : filteredPosts.length === 0 ? (
              <div className="text-center py-12 text-gray-500">
                <i className="fas fa-comments text-4xl mb-4 text-gray-300"></i>
                <p className="text-base">עדיין אין הודעות בנושא זה. היה הראשון לפרסם!</p>
              </div>
            ) : (
              <div>
                {filteredPosts.map(post => (
                  <div key={post.id} className="forum-post">
                    <div className="forum-header">
                      <div className="flex items-center gap-2">
                        {post.author_name ? (
                          <span className="author-badge">
                            <i className="fas fa-user ml-1"></i>
                            {post.author_name}
                          </span>
                        ) : (
                          <span className="forum-meta">
                            <i className="fas fa-user-secret ml-1"></i>
                            אנונימי
                          </span>
                        )}
                        <span className="forum-meta">
                          <i className="fas fa-tag ml-1"></i>
                          {post.topic}
                        </span>
                      </div>
                      <span className="forum-meta">
                        <i className="far fa-clock ml-1"></i>
                        {formatDate(post.created_at)}
                      </span>
                    </div>
                    <p className="forum-post-content mb-4">{post.content}</p>
                    <div className="flex items-center gap-3">
                      <button
                        onClick={() => handleLike(post.id, post.likes)}
                        className={`like-button ${likedPosts.has(post.id) ? 'liked' : ''}`}
                      >
                        <i className={`fa${likedPosts.has(post.id) ? 's' : 'r'} fa-heart`}></i>
                        <span>{post.likes || 0}</span>
                      </button>
                      <button
                        onClick={() => setReplyingTo(replyingTo === post.id ? null : post.id)}
                        className="like-button"
                      >
                        <i className="fas fa-reply"></i>
                        <span>{post.replies?.length || 0}</span>
                      </button>
                    </div>

                    {post.replies && post.replies.length > 0 && (
                      <div className="reply-section">
                        {post.replies.map(reply => (
                          <div key={reply.id} className="reply-item">
                            <div className="forum-header" style={{borderBottom: 'none', paddingBottom: 0, marginBottom: '0.5rem'}}>
                              {reply.author_name ? (
                                <span className="author-badge" style={{fontSize: '0.7rem', padding: '0.15rem 0.5rem'}}>
                                  <i className="fas fa-user ml-1"></i>
                                  {reply.author_name}
                                </span>
                              ) : (
                                <span className="forum-meta">
                                  <i className="fas fa-user-secret ml-1"></i>
                                  אנונימי
                                </span>
                              )}
                              <span className="forum-meta">
                                {formatDate(reply.created_at)}
                              </span>
                            </div>
                            <p className="text-sm text-gray-700">{reply.content}</p>
                          </div>
                        ))}
                      </div>
                    )}

                    <div className={`reply-form ${replyingTo === post.id ? 'active' : ''}`}>
                      <textarea
                        className="reply-textarea"
                        placeholder="כתוב תגובה..."
                        value={replyContent}
                        onChange={(e) => setReplyContent(e.target.value)}
                        maxLength={500}
                      />
                      <div className="flex justify-between items-center mt-2">
                        <span className="text-xs text-gray-500">{replyContent.length}/500</span>
                        <div className="flex gap-2">
                          <button
                            onClick={() => {
                              setReplyingTo(null);
                              setReplyContent('');
                            }}
                            className="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition text-sm"
                          >
                            ביטול
                          </button>
                          <button
                            onClick={() => handleSubmitReply(post.id)}
                            disabled={!replyContent.trim() || posting}
                            className="custom-button px-4 py-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed"
                          >
                            {posting ? 'שולח...' : 'שלח תגובה'}
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}

            {showPasscodePopup && (
              <div className="passcode-popup">
                <div className="passcode-content">
                  <h3 className="text-xl font-bold text-gray-800 mb-4 text-center">
                    <i className="fas fa-key text-purple-600 ml-2"></i>
                    פרסום עם שם
                  </h3>
                  <p className="text-sm text-gray-600 mb-4 text-center">הזן את הקוד המיוחד כדי לבחור שם</p>
                  <input
                    type="password"
                    className="w-full p-3 border border-gray-300 rounded-lg mb-4 text-center text-lg font-mono"
                    placeholder="הזן קוד"
                    value={passcode}
                    onChange={(e) => setPasscode(e.target.value)}
                    onKeyPress={(e) => e.key === 'Enter' && handlePasscodeSubmit()}
                  />
                  {passcode === CORRECT_PASSCODE && (
                    <div className="mb-4">
                      <label className="text-sm font-semibold text-gray-700 mb-2 block">בחר שם:</label>
                      <select
                        className="w-full p-3 border border-gray-300 rounded-lg"
                        value={selectedAuthor}
                        onChange={(e) => setSelectedAuthor(e.target.value)}
                      >
                        <option value="">בחר מהרשימה</option>
                        {AUTHORS.map(author => (
                          <option key={author} value={author}>{author}</option>
                        ))}
                      </select>
                    </div>
                  )}
                  <div className="flex gap-2">
                    <button
                      onClick={() => {
                        setShowPasscodePopup(false);
                        setPasscode('');
                      }}
                      className="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition font-semibold"
                    >
                      ביטול
                    </button>
                    <button
                      onClick={handlePasscodeSubmit}
                      className="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition font-semibold"
                    >
                      אישור
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        </section>
      );
    };

    const Hero = () => (
      <section className="bg-white py-12 sm:py-20 content-container">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <h2 className="text-3xl sm:text-4xl font-bold text-gray-800 mb-6">ברוכים הבאים להחבר׳ה הטובים בגרסת ה-Web</h2>
          <p className="text-lg text-gray-600 mb-8 max-w-2xl mx-auto">רשת חברתית ייחודית לחבר׳ה הטובים, המשלבת קהילה, תרבות וחדשנות.</p>
          <a href="#sections" className="custom-button inline-block px-8 py-3 font-bold text-lg">גלה את המדורים שלנו</a>
        </div>
      </section>
    );

    const Sections = () => (
      <section id="sections" className="py-12 sm:py-20 bg-gray-50 content-container">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <h3 className="text-3xl font-bold text-gray-800 text-center mb-12">המדורים שלנו</h3>
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
            <div className="card">
              <h4 className="card-title">ויקיחברה</h4>
              <p className="text-base text-gray-600 mb-4 flex-grow">מאגר מידע מקיף על החברה שלנו, ההיסטוריה וההישגים שלה.</p>
              <a href="https://israelpolice.github.io/Balakif/pages/good-guys.html" className="custom-button inline-block px-6 py-2 font-bold text-base">לגלות עוד</a>
            </div>
            <div className="card">
              <h4 className="card-title">בן זונה של השנה</h4>
              <p className="text-base text-gray-600 mb-4 flex-grow">תוצאות התחרות השנתית שלנו לפי שנים, ההיסטוריה המלאה.</p>
              <a href="https://israelpolice.github.io/Balakif/pages/bhirot.html" className="custom-button inline-block px-6 py-2 font-bold text-base">צפה בתוצאות</a>
            </div>
            <div className="card">
              <h4 className="card-title">בלאקיף - צפייה ישירה</h4>
              <p className="text-base text-gray-600 mb-4 flex-grow">גישה לטרילוגיית סרטי בלאקיף, הזמינים לצפייה ישירה.</p>
              <a href="https://israelpolice.github.io/Balakif/pages/watchbalakif.html" className="custom-button inline-block px-6 py-2 font-bold text-base">צפה עכשיו</a>
            </div>
          </div>
          <h3 className="text-3xl font-bold text-gray-800 text-center mb-8">משחקי החבר׳ה</h3>
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <div className="game-card">
              <img
                src="https://download.logo.wine/logo/Akinator/Akinator-Logo.wine.png"
                alt="אקינטור החבר׳ה"
                className="game-image"
                onError={(e) => { console.log('Failed to load Akinator image'); e.target.src = 'https://via.placeholder.com/100'; }}
              />
              <h4 className="game-card-title">אקינטור החבר׳ה</h4>
              <p className="text-base text-white mb-4 flex-grow">נסו לנצח את האקינטור, תחשבו על דמות מהחבר׳ה.</p>
              <a href="https://israelpolice.github.io/Balakif/goodguysakinator/index.html" className="custom-button inline-block px-6 py-2 font-bold text-base bg-white text-blue-600 hover:bg-gray-100">שחק עכשיו</a>
            </div>
            <div className="game-card">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/FIFA_Ultimate_Team_logo_FIFA_18_to_FIFA_20.png/640px-FIFA_Ultimate_Team_logo_FIFA_18_to_FIFA_20.png"
                alt="החבר׳ה הטובים Ultimate Team"
                className="game-image"
                onError={(e) => { console.log('Failed to load Ultimate Team image'); e.target.src = 'https://via.placeholder.com/100'; }}
              />
              <h4 className="game-card-title">החבר׳ה הטובים Ultimate Team</h4>
              <p className="text-base text-white mb-4 flex-grow">בנו את קבוצת החלומות של החבר׳ה הטובים והתחרו!</p>
              <a href="https://israelpolice.github.io/Balakif/pages/ultimateteam.html" className="custom-button inline-block px-6 py-2 font-bold text-base bg-white text-blue-600 hover:bg-gray-100">שחק עכשיו</a>
            </div>
            <div className="game-card" style={{background: 'linear-gradient(135deg, #ff4444 0%, #0066cc 50%, #00cc66 100%)'}}>
              <div className="game-image" style={{fontSize: '4rem'}}>🌍</div>
              <h4 className="game-card-title">Hevre's Empire</h4>
              <p className="text-base text-white mb-4 flex-grow">אסטרטגיה גיאופוליטית - נהל מדינות, צור בריתות, כבוש את העולם!</p>
              <a href="../chromaverse/index.html" className="custom-button inline-block px-6 py-2 font-bold text-base bg-white text-red-600 hover:bg-gray-100">שחק עכשיו</a>
            </div>
          </div>
        </div>
      </section>
    );

    const Footer = () => (
      <footer className="bg-gray-800 text-white py-10 content-container">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <p className="text-sm">© 2025 The Hevre Hatovim Inc. כל הזכויות שמורות.</p>
          <div className="mt-4 space-x-4">
            <a href="#privacy" className="text-gray-400 hover:text-white transition text-sm">מדיניות פרטיות</a>
            <a href="#terms" className="text-gray-400 hover:text-white transition text-sm">תנאי שימוש</a>
            <a href="#contact" className="text-gray-400 hover:text-white transition text-sm">צור קשר</a>
          </div>
        </div>
      </footer>
    );

    const App = () => (
      <div>
        <AuthPopup />
        <Nav />
        <Leadership />
        <Forum />
        <Hero />
        <Sections />
        <Footer />
      </div>
    );

    try {
      console.log('Attempting to create React root...');
      const root = ReactDOM.createRoot(document.getElementById('root'));
      console.log('Rendering React app...');
      root.render(<App />);
    } catch (error) {
      console.error('Error rendering React app:', error);
      document.getElementById('root').innerHTML = '<div id="error">שגיאה בטעינת האתר. אנא בדוק את הקונסולה ב-F12 לפרטים או נסה שוב מאוחר יותר.</div>';
    }
  </script>
</body>
</html>
